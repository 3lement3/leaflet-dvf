/*! leaflet-dvf 18-07-2016 */
/*
 @preserve Leaflet Data Visualization Framework, a JavaScript library for creating thematic maps using Leaflet
 (c) 2013-2015, Scott Fairgrieve, HumanGeo
 */
!function(a,b){"function"==typeof define&&define.amd?define(["leaflet"],a):"object"==typeof exports&&(module.exports=a(require("leaflet"))),"undefined"!=typeof b&&b.L&&(b.L.YourPlugin=a(L))}(function(a){a.LinearFunction=a.Class.extend({options:{constrainX:!1},initialize:function(a,b,c){this.setOptions(c),this.setRange(a,b)},_calculateParameters:function(a,b){0===this._xRange?(this._slope=0,this._b=a.y):(this._slope=(b.y-a.y)/this._xRange,this._b=a.y-this._slope*a.x)},_arrayToPoint:function(a){return{x:a[0],y:a[1]}},setOptions:function(b){a.Util.setOptions(this,b),this._preProcess=this.options.preProcess,this._postProcess=this.options.postProcess},getBounds:function(){var b=Math.min(this._minPoint.x,this._maxPoint.x),c=Math.max(this._minPoint.x,this._maxPoint.x),d=Math.min(this._minPoint.y,this._maxPoint.y),e=Math.max(this._minPoint.y,this._maxPoint.y);return[new a.Point(b,d),new a.Point(c,e)]},setRange:function(a,b){return a=a instanceof Array?this._arrayToPoint(a):a,b=b instanceof Array?this._arrayToPoint(b):b,this._minPoint=a,this._maxPoint=b,this._xRange=b.x-a.x,this._yRange=b.y-a.y,this._calculateParameters(a,b),this},setMin:function(a){return this.setRange(a,this._maxPoint),this},setMax:function(a){return this.setRange(this._minPoint,a),this},setPreProcess:function(a){return this._preProcess=a,this},setPostProcess:function(a){return this._postProcess=a,this},constrainX:function(a){return a=Number(a),this.options.constrainX&&(a=Math.max(a,this._minPoint.x),a=Math.min(a,this._maxPoint.x)),a},evaluate:function(a){var b;return this._preProcess&&(a=this._preProcess(a)),b=Number((this._slope*a).toFixed(6))+Number(this._b.toFixed(6)),this._postProcess&&(b=this._postProcess(b,a)),b},random:function(){var a=Math.random()*this._xRange+this._minPoint.x;return this.evaluate(a)},sample:function(a){a=Math.max(a,2);for(var b=a-1,c=this._xRange/b,d=this._minPoint.x,e=[];d<=this._maxPoint.x;)e.push(this.evaluate(d)),d+=c;return e},evaluatePercent:function(a){return this.getPointAtPercent(a).y},getPointAtPercent:function(b){var c=this._xRange*b,d=this._yRange*b,e=this._minPoint.x+c,f=this._minPoint.y+d;return new a.Point(e,f)},samplePoints:function(b){b=Math.max(b,2);for(var c=b-1,d=this._xRange/c,e=this._minPoint.x,f=[];e<=this._maxPoint.x;)f.push(new a.Point(e,this.evaluate(e))),e+=d;return f},getIntersectionPoint:function(b){var c=null;if(this._slope!==b._slope){var d=(this._b-b._b)/(b._slope-this._slope),e=this.evaluate(d);c=new a.Point(d,e)}return c}}),a.ColorFunction=a.LinearFunction.extend({options:{alpha:1,includeAlpha:!1},initialize:function(b,c,d){a.Util.setOptions(this,d),this._parts=[],this._dynamicPart=null,this._outputPrecision=0,this._prefix=null,this._formatOutput=function(a){return a.toFixed(this._outputPrecision)},this._mapOutput=function(a){for(var b=[],c=0,d=this._parts.length;c<d;++c){var e=this._parts[c];b.push(a[e])}return this.options.includeAlpha&&b.push(this.options.alpha),b},this._getColorString=function(a){a=this._formatOutput(a),this.options[this._dynamicPart]=a;var b=this._mapOutput(this.options);return this._writeColor(this._prefix,b)},this._writeColor=function(a,b){return this.options.includeAlpha&&(a+="a"),a+"("+b.join(",")+")"},d=a.extend({},this.options);var e=function(b){d&&d.postProcess&&(b=d.postProcess.call(this,b));var c=this._getColorString(b);return(a.Browser.ie&&c.indexOf("hsl")>-1||d.rgb)&&(c=a.hslColor(c).toRGBString()),c};a.LinearFunction.prototype.initialize.call(this,b,c,{preProcess:this.options.preProcess,postProcess:e})}}),a.HSLColorFunction=a.ColorFunction.extend({initialize:function(b,c,d){a.ColorFunction.prototype.initialize.call(this,b,c,d),this._parts=["outputHue","outputSaturation","outputLuminosity"],this._prefix="hsl",this._outputPrecision=2}}),a.RGBColorFunction=a.ColorFunction.extend({initialize:function(b,c,d){a.ColorFunction.prototype.initialize.call(this,b,c,d),this._parts=["outputRed","outputBlue","outputGreen"],this._prefix="rgb",this._outputPrecision=0}}),a.RGBRedFunction=a.LinearFunction.extend({options:{outputGreen:0,outputBlue:0},initialize:function(b,c,d){a.RGBColorFunction.prototype.initialize.call(this,b,c,d),this._dynamicPart="outputRed"}}),a.RGBBlueFunction=a.LinearFunction.extend({options:{outputRed:0,outputGreen:0},initialize:function(b,c,d){a.RGBColorFunction.prototype.initialize.call(this,b,c,d),this._dynamicPart="outputBlue"}}),a.RGBGreenFunction=a.LinearFunction.extend({options:{outputRed:0,outputBlue:0},initialize:function(b,c,d){a.RGBColorFunction.prototype.initialize.call(this,b,c,d),this._dynamicPart="outputGreen"}}),a.RGBColorBlendFunction=a.LinearFunction.extend({initialize:function(b,c,d,e){d=new a.RGBColor(d),e=new a.RGBColor(e);var f=d.r(),g=e.r(),h=d.g(),i=e.g(),j=d.b(),k=e.b();this._minX=b,this._maxX=c,this._redFunction=new a.LinearFunction(new a.Point(b,f),new a.Point(c,g)),this._greenFunction=new a.LinearFunction(new a.Point(b,h),new a.Point(c,i)),this._blueFunction=new a.LinearFunction(new a.Point(b,j),new a.Point(c,k))},getBounds:function(){var b=this._redFunction.getBounds(),c=this._greenFunction.getBounds(),d=this._blueFunction.getBounds(),e=Math.min(b[0].y,c[0].y,d[0].y),f=Math.max(b[0].y,c[0].y,d[0].y);return[new a.Point(b[0].x,e),new a.Point(b[1].x,f)]},evaluate:function(b){return new a.RGBColor([this._redFunction.evaluate(b),this._greenFunction.evaluate(b),this._blueFunction.evaluate(b)]).toRGBString()}}),a.HSLHueFunction=a.HSLColorFunction.extend({options:{outputSaturation:"100%",outputLuminosity:"50%"},initialize:function(b,c,d){a.HSLColorFunction.prototype.initialize.call(this,b,c,d),this._dynamicPart="outputHue"}}),a.HSLSaturationFunction=a.LinearFunction.extend({options:{outputHue:0,outputLuminosity:"50%"},initialize:function(b,c,d){a.HSLColorFunction.prototype.initialize.call(this,b,c,d),this._formatOutput=function(a){return(100*a).toFixed(this._outputPrecision)+"%"},this._dynamicPart="outputSaturation"}}),a.HSLLuminosityFunction=a.LinearFunction.extend({options:{outputHue:0,outputSaturation:"100%"},initialize:function(b,c,d){a.HSLColorFunction.prototype.initialize.call(this,b,c,d),this._formatOutput=function(a){return(100*a).toFixed(this._outputPrecision)+"%"},this._dynamicPart="outputLuminosity"}}),a.HSLColorBlendFunction=a.LinearFunction.extend({initialize:function(b,c,d,e){d=new a.HSLColor(d),e=new a.HSLColor(e);var f=d.h(),g=e.h(),h=d.s(),i=e.s(),j=d.l(),k=e.l();this._minX=b,this._maxX=c,this._hueFunction=new a.LinearFunction(new a.Point(b,f),new a.Point(c,g)),this._saturationFunction=new a.LinearFunction(new a.Point(b,h),new a.Point(c,i)),this._luminosityFunction=new a.LinearFunction(new a.Point(b,j),new a.Point(c,k))},getBounds:function(){var b=this._hueFunction.getBounds(),c=this._saturationFunction.getBounds(),d=this._luminosityFunction.getBounds(),e=Math.min(b[0].y,c[0].y,d[0].y),f=Math.max(b[0].y,c[0].y,d[0].y);return[new a.Point(b[0].x,e),new a.Point(b[1].x,f)]},evaluate:function(b){return new a.HSLColor([this._hueFunction.evaluate(b),this._saturationFunction.evaluate(b),this._luminosityFunction.evaluate(b)]).toHSLString()}}),a.PiecewiseFunction=a.LinearFunction.extend({options:{constrainX:!0},initialize:function(b,c){a.Util.setOptions(this,c),this._functions=b;var d,e;d=b[0].getBounds()[0],e=b[b.length-1].getBounds()[1],a.LinearFunction.prototype.initialize.call(this,d,e,{preProcess:this.options.preProcess,postProcess:this.options.postProcess})},_getFunction:function(a){var b,c,d,e;if(a<this._minPoint.x)e=this._functions[0];else if(a>=this._maxPoint.x)e=this._functions[this._functions.length-1];else for(var f=0;f<this._functions.length&&(e=this._functions[f],b=e.getBounds(),c=b[0],d=b[1],!(a>=c.x&&a<d.x));++f);return e},evaluate:function(a){var b,c=null;return a=this.constrainX(a),this._preProcess&&(a=this._preProcess(a)),b=this._getFunction(a),b&&(c=b.evaluate(a),this._postProcess&&(c=this._postProcess(c,a))),c}}),a.ColorClassFunction=a.PiecewiseFunction.extend({options:{interpolate:!1},initialize:function(b,c,d){var e,f=[];a.Util.setOptions(this,d);for(var g=0,h=b.length-1;g<h;++g){var i=b[g],j=b[g+1],k=c[g],l=this.options.interpolate?c[Math.min(c.length-1,g+1)]:c[g];e=new a.RGBColorBlendFunction(i,j,k,l),f.push(e)}a.PiecewiseFunction.prototype.initialize.call(this,f)}}),a.CustomColorFunction=a.PiecewiseFunction.extend({options:{interpolate:!0},initialize:function(b,c,d,e){a.setOptions(this,e);for(var f,g,h=this.options.interpolate?d.length-1:d.length,i=[],j=new a.LinearFunction([0,b],[h,c]),k=0;k<h;++k)g=k+1,f=this.options.interpolate?new a.RGBColorBlendFunction(j.evaluate(k),j.evaluate(g),d[k],d[g]):new a.RGBColorBlendFunction(j.evaluate(k),j.evaluate(g),d[k],d[k]),i.push(f);j=null,a.PiecewiseFunction.prototype.initialize.call(this,i)}}),a.CategoryFunction=a.Class.extend({initialize:function(b,c){a.Util.setOptions(this,c),this._categoryKeys=Object.keys(b),this._categoryMap=b,this._preProcess=this.options.preProcess,this._postProcess=this.options.postProcess},evaluate:function(a){var b;return this._preProcess&&(a=this._preProcess(a)),b=this._categoryMap[a],this._postProcess&&(b=this._postProcess(b,a)),b},getCategories:function(){return this._categoryKeys}}),a.categoryFunction=function(b,c){return new a.CategoryFunction(b,c)}},window),function(a,b){"function"==typeof define&&define.amd?define(["leaflet"],a):"object"==typeof exports&&(module.exports=a(require("leaflet"))),"undefined"!=typeof b&&b.L&&(b.L.YourPlugin=a(L))}(function(a){Array.prototype.indexOf||(Array.prototype.indexOf=function(a,b){for(var c=b||0,d=this.length;c<d;c++)if(this[c]===a)return c;return-1}),Object.keys||(Object.keys=function(){var a=Object.prototype.hasOwnProperty,b=!{toString:null}.propertyIsEnumerable("toString"),c=["toString","toLocaleString","valueOf","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","constructor"],d=c.length;return function(e){var f,g,h;if("object"!=typeof e&&"function"!=typeof e||null===e)throw new TypeError("Object.keys called on non-object");f=[];for(g in e)a.call(e,g)&&f.push(g);if(b)for(h=0;h<d;h++)a.call(e,c[h])&&f.push(c[h]);return f}}()),a.Util.guid=function(){var a=function(){return Math.floor(65536*(1+Math.random())).toString(16).substring(1)};return a()+a()+"-"+a()+"-"+a()+"-"+a()+"-"+a()+a()+a()},a.Util.getProperty=function(a,b,c){return b in a?a[b]:c},a.Util.setFieldValue=function(a,b,c){for(var d,e=b.split("."),f=a,g=0,h=e.length-1;g<h;++g)d=e[g],f[d]=f[d]||{},f=f[d];f[e[e.length-1]]=c},a.Util.getFieldValue=function(a,b){var c=null;if(b){for(var d,e,f,g,h,i,j,k=b.split("."),l=a,m=-1,n=0,o=k.length;n<o;++n)if(d=k[n],m=d.indexOf("["),m>-1){i=d.substring(m),d=d.substring(0,m),i=i.replace("[","").replace("]",""),e=i.split("="),f=e[0],g=e[1],l=l[d];for(var p=0;p<l.length;++p)h=l[p],j=h[f],j&&j===g&&(l=h)}else{if(!l||!l.hasOwnProperty(d)){l=null;break}l=l[d]}c=l}else c=a;return c},a.Util.getNumericRange=function(b,c){var d=Number.MAX_VALUE,e=Number.MIN_VALUE;for(var f in b)if(b.hasOwnProperty(f)){var g=b[f],h=a.Util.getFieldValue(g,c);d=Math.min(d,h),e=Math.max(e,h)}return[d,e]},a.Util.pointToGeoJSON=function(){var a={type:"Feature",geometry:{type:"Point",coordinates:[this._latlng[1],this._latlng[0]]},properties:{}};for(var b in this.options)if(this.options.hasOwnProperty(b)){var c=this.options[b];"function"!=typeof c&&(a.properties[b]=c)}return a},a.Util.updateLayer=function(b,c){b.eachLayer&&!b instanceof a.FeatureGroup?b.eachLayer(function(b){a.Util.updateLayer(b,c)}):c.call(this,b)},a.CategoryLegend=a.Class.extend({initialize:function(b){a.setOptions(this,b)},generate:function(b){b=b||{};var c=document.createElement("div"),d=a.DomUtil.create("div","legend",c),e=b.className,f=this.options;e&&a.DomUtil.addClass(d,e),b.title&&(a.DomUtil.create("div","legend-title",d).innerHTML=b.title);for(var g in f){categoryOptions=f[g];var h=categoryOptions.displayName||g,i=a.DomUtil.create("div","data-layer-legend",d),j=a.DomUtil.create("div","legend-box",i);a.DomUtil.create("div","key",i).innerHTML=h,a.StyleConverter.applySVGStyle(j,categoryOptions)}return c.innerHTML}}),a.LegendIcon=a.DivIcon.extend({initialize:function(b,c,d){var e,f=document.createDocumentFragment(),g=document.createElement("div","",f),h=a.DomUtil.create("div","legend",g),i=a.DomUtil.create("div","title",h),j=a.DomUtil.create("div","legend-box",h),k=a.DomUtil.create("div","legend-values",h),l=c.title||c.name;l&&(i.innerHTML=l);for(var m in b)e=b[m],a.DomUtil.create("div","key",k).innerHTML=e.name||m,a.DomUtil.create("div","value",k).innerHTML=e.value;a.StyleConverter.applySVGStyle(j,c),d.html=g.innerHTML,d.className=d.className||"legend-icon",a.DivIcon.prototype.initialize.call(this,d)}}),a.legendIcon=function(b,c,d){return new a.LegendIcon(b,c,d)},a.GeometryUtils={getName:function(a){var b=null;if(a&&a.features)for(var c=0;c<a.features.length;++c){var d=a.features[c];if(d.properties&&d.properties.name){b=d.properties.name;break}}return b},getGeoJSONLocation:function(b,c,d,e){var f=function(b){return a.Util.getFieldValue(b,d)};d&&"function"==typeof d&&(f=d);var g=new a.GeoJSON(b,{pointToLayer:function(b,f){var g={location:f,text:d?a.Util.getFieldValue(c,d):[f.lat.toFixed(3),f.lng.toFixed(3)].join(", "),center:f};return e(g,c)}}),h=null;try{h=a.GeometryUtils.loadCentroid(b)}catch(a){console.log("Error loading centroid for "+JSON.stringify(b))}return{location:g,text:d?a.Util.getFieldValue(c,d):null,center:h}},mergeProperties:function(b,c,d){var e,f,g=c.features,h=a.GeometryUtils.indexFeatureCollection(g,d),i={type:"FeatureCollection",features:[]};for(var j in b)if(b.hasOwnProperty(j)&&(e=b[j],f=e[d])){var k=h[f];for(var l in e)k.properties[l]=e[l];i.features.push(k)}return i},indexFeatureCollection:function(a,b){for(var c,d,e,f=a.features,g={},h=0;h<f.length;++h)if(c=f[h],d=c.properties,e=d[b],e in g){var i=g[e];"GeometryCollection"!==i.geometry.type?g[e]={type:"Feature",geometry:{type:"GeometryCollection",geometries:[c.geometry,i.geometry]}}:i.geometry.geometries.push(c.geometry)}else g[e]=c;return g},arrayToMap:function(a,b,c){for(var d,e,f,g={},h=0;h<a.length;++h)d=a[h],e=d[b],f=c?d[c]:d,g[e]=f;return g},arrayToMaps:function(a,b){for(var c,d,e,f,g,h,i,j=[],k=0,l=b.length;k<l;++k)j.push({});for(var m=0;m<a.length;++m){d=a[m];for(var n=0;n<b.length;++n)c=j[n],g=b[n],h=g.from,i=g.to,e=d[h],f=i?d[i]:d,c[e]=f}return j},loadCentroid:function(b){var c,d,e,f=null;if(b.geometry&&"Point"===b.geometry.type)f=new a.LatLng(b.geometry.coordinates[1],b.geometry.coordinates[0]);else if("undefined"!=typeof jsts){var g=new jsts.io.GeoJSONParser,h=g.read(b);if(h.getCentroid)c=h.getCentroid(),d=c.coordinate.x,e=c.coordinate.y;else if(h.features){for(var i=0,j=0,k=0,l=h.features.length;k<l;++k)c=h.features[k].geometry.getCentroid(),i+=c.coordinate.x,j+=c.coordinate.y;d=i/h.features.length,e=j/h.features.length}else c=h.geometry.getCentroid(),d=c.coordinate.x,e=c.coordinate.y;f=new a.LatLng(e,d)}return f},loadCentroids:function(b){var c,d={};for(var e in b)c=b[e],d[e]=a.GeometryUtils.loadCentroid(c);return d}},a.SVGPathBuilder=a.Class.extend({initialize:function(b,c,d){this._points=b||[],this._innerPoints=c||[],a.setOptions(this,d)},options:{closePath:!0},_getPathString:function(b,c){var d="";if(b.length>0){var e=b[0];c=null!==c?c:2;var f="M",g="L",h="Z";a.Browser.vml&&(c=0,f="m",g="l",h="xe"),d=f+e.x.toFixed(c)+" "+e.y.toFixed(c);for(var i=1;i<b.length;i++)e=b[i],d+=g+e.x.toFixed(c)+" "+e.y.toFixed(c);this.options.closePath&&(d+=h)}return d},addPoint:function(a,b){b?this._innerPoints.push(a):this._points.push(a)},build:function(a){a=a||this.options.digits;var b=this._getPathString(this._points,a);return this._innerPoints&&(b+=this._getPathString(this._innerPoints,a)),b}}),a.StyleConverter={keyMap:{fillColor:{property:["background-color"],valueFunction:function(a){return a}},color:{property:["color","border-top-color","border-right-color","border-bottom-color","border-left-color"],valueFunction:function(a){return a}},weight:{property:["border-width"],valueFunction:function(a){return Math.ceil(a)+"px"}},lineWeight:{property:["border-width"],valueFunction:function(a){return Math.ceil(a)+"px"}},stroke:{property:["border-style"],valueFunction:function(a){return a===!0?"solid":"none"}},dashArray:{property:["border-style"],valueFunction:function(a){var b="solid";return a&&(b="dashed"),b}},barThickness:{property:["height"],valueFunction:function(a){return a+"px"}},radius:{property:["height"],valueFunction:function(a){return 2*a+"px"}},radiusY:{property:["height"],valueFunction:function(a){return 2*a+"px"}},fillOpacity:{property:["opacity"],valueFunction:function(a){return a}}},applySVGStyle:function(b,c,d){var e=a.StyleConverter.keyMap;d&&(e=a.Util.extend(e,d)),b.style.borderStyle="solid";for(var f in c)a.StyleConverter.setCSSProperty(b,f,c[f],e);return b},setCSSProperty:function(b,c,d,e){e=e||a.StyleConverter.keyMap;var f=e[c],g="";if(f)for(var h=f.property,i=0,j=h.length;i<j;++i)g+=h[i]+":"+f.valueFunction(d)+";";return b.style.cssText+=g,b}},a.StylesBuilder=a.Class.extend({initialize:function(a,b){this._categories=a,this._styleFunctionMap=b,this._buildStyles()},_buildStyles:function(){for(var a,b,c,d={},e=0;e<this._categories.length;++e){a=this._categories[e],d[a]={};for(var f in this._styleFunctionMap)b=this._styleFunctionMap[f],c=b.evaluate?b.evaluate(e):"function"==typeof b?b(e):b,d[a][f]=c}this._styleMap=d},getStyles:function(){return this._styleMap}}),a.PaletteBuilder=a.Class.extend({initialize:function(a){this._styleFunctionMap=a},generate:function(b){b=b||{};var c=document.createElement("div"),d=a.DomUtil.create("div","palette",c),e=b.count||10,f=function(a){for(var b=[],c=0;c<a;++c)b.push(c);return b}(e),g=new a.StylesBuilder(f,this._styleFunctionMap),h=g.getStyles();b.className&&a.DomUtil.addClass(d,b.className);for(var i in h){var j=a.DomUtil.create("i","palette-element",d),k=h[i];a.StyleConverter.applySVGStyle(j,k)}return c.innerHTML}}),a.HTMLUtils={buildTable:function(b,c,d){function e(a,b){for(var c=0,d=a.length;c<d;c++)if(a[c]===b)return!0;return!1}c=c||"table table-condensed table-striped table-bordered";for(var f=document.createDocumentFragment(),g=a.DomUtil.create("table",c,f),h=a.DomUtil.create("thead","",g),i=a.DomUtil.create("tbody","",g),j=a.DomUtil.create("tr","",h),k=["Name","Value"],l=0,m=k.length;l<m;l++){var n=a.DomUtil.create("th","",j);n.innerHTML=k[l]}d=d||[];for(var o in b)if(b.hasOwnProperty(o)&&!e(d,o)){var p=b[o];if("object"==typeof p){var q=document.createElement("div");q.appendChild(a.HTMLUtils.buildTable(p,d)),p=q.innerHTML}var r=a.DomUtil.create("tr","",i),s=[o,p];for(l=0,m=s.length;l<m;l++){var t=a.DomUtil.create("td","",r);t.innerHTML=s[l]}}return g}},a.AnimationUtils={easingFunctions:{linear:function(a,b){return a/b},easeIn:function(a,b){return Math.pow(a/b,5)},easeOut:function(a,b){return 1-Math.pow(1-a/b,5)},easeInOut:function(a,b){return a/=b/2,a<1?.5*Math.pow(a,4):(a-=2,-.5*(Math.pow(a,4)-2))}},animate:function(b,c){var d=c.from||{},e=c.to||{},f=c.duration||500,g={},h=c.easing||a.AnimationUtils.easingFunctions.linear,i=c.animationEnd;for(var j in d)if("color"!==j&&"fillColor"!==j&&"position"!==j&&e[j])g[j]=new a.LinearFunction([0,d[j]],[1,e[j]]);else if("color"!==j&&"fillColor"!==j||d[j]===e[j])"position"===j&&e[j]&&(g[j]=new a.LinearFunction([d[j].x,d[j].y],[e[j].x,e[j].y],{postProcess:function(a,b){return{x:b,y:a}}}));else{var k=a.Color.getColor(d[j]),l=a.Color.getColor(e[j]);g[j]=new a.RGBColorBlendFunction(0,1,k.toRGBString(),l.toRGBString())}var m={},n=+new Date,o=function(){var c=+new Date-n,d=h(c,f);if(d<1){for(var e in g)m[e]=g[e].evaluate(d);b.options=a.extend({},b.options,m),b.setStyle(b.options).redraw(),b._animId=a.Util.requestAnimFrame(o)}else a.Util.cancelAnimFrame(b._animId),b._animId=null,i&&i()};b._animId=a.Util.requestAnimFrame(o)},buildDistanceIndex:function(a){var b={},c=0;b.index=[0];for(var d=0,e=a.length;d<e-1;++d)c+=a[d].distanceTo(a[d+1]),b.index.push(c);return b.totalDistance=c,b},distanceToPoints:function(a,b,c,d){var e={};if(c>=b.totalDistance)e.distances=[b.totalDistance,b.totalDistance],e.points=[a[a.length-1],a[a.length-1]],e.index=a.length-1;else for(var f=d,g=b.index.length;f<g-1;++f)if(c>=b.index[f]&&c<b.index[f+1]){e.distances=[b.index[f],b.index[f+1]],e.points=[a[f],a[f+1]],e.index=f;break}return e},getInterpolator:function(b){return new a.LinearFunction([b[0].lng,b[0].lat],[b[1].lng,b[1].lat])},animateLine:function(b,c){var d=c.from||{},e=c.to||{},f=c.path||b._latlngs||[],g=c.duration||1e3,h=c.easing||a.AnimationUtils.easingFunctions.linear,i=c.animationEnd,j=+new Date,k=this,l={},m=this.buildDistanceIndex(f),n=m.totalDistance/g,o=c.update||function(b,c,d){b.setLatLng(new a.LatLng(d.y,d.x))};for(var p in d)if("color"!==p&&"fillColor"!==p&&"position"!==p&&e[p])l[p]=new a.LinearFunction([0,d[p]],[1,e[p]]);else if("color"!==p&&"fillColor"!==p||d[p]===e[p])"position"===p&&e[p]&&(l[p]=new a.LinearFunction([d[p].x,d[p].y],[e[p].x,e[p].y],{postProcess:function(a,b){return{x:b,y:a}}}));else{var q=a.Color.getColor(d[p]),r=a.Color.getColor(e[p]);l[p]=new a.RGBColorBlendFunction(0,1,q.toRGBString(),r.toRGBString())}var s=0,t=function(c){var d=+new Date-j,e=d*n,p=k.distanceToPoints(f,m,e,s),q=p.distances[0]/m.totalDistance,r=p.distances[1]/m.totalDistance,u=k.getInterpolator(p.points),v=h(d,g),w=(v-q)/(r-q||1),x=u.getPointAtPercent(w),y={};if(o(b,p.points,x),s=p.index,v>=1)a.Util.cancelAnimFrame(b._animId),i&&i();else{for(var z in l)y[z]=l[z].evaluate(v);b.options=a.extend({},b.options,y),b.setStyle(b.options),b._animId=a.Util.requestAnimFrame(t)}u=null,x=null};b._animId=a.Util.requestAnimFrame(t)}},a.Color=a.Class.extend({statics:{getColor:function(b){return b.indexOf("#")>-1||b.indexOf("rgb")>-1?new a.RGBColor(b):new a.HSLColor(b)}},initialize:function(a){this._rgb=[0,0,0],this._hsl=[0,1,.5],this._a=1,a&&this.parseColorDef(a)},parseColorDef:function(a){},rgbToHSL:function(a,b,c){a/=255,b/=255,c/=255;var d,e,f=Math.max(a,b,c),g=Math.min(a,b,c),h=(f+g)/2;if(f==g)d=e=0;else{var i=f-g;switch(e=h>.5?i/(2-f-g):i/(f+g),f){case a:d=(b-c)/i+(b<c?6:0);break;case b:d=(c-a)/i+2;break;case c:d=(a-b)/i+4}d/=6}return[d,e,h]},hslToRGB:function(a,b,c){var d,e,f,g=function(a,b,c){return c<0&&(c+=1),c>1&&(c-=1),c<1/6?a+6*(b-a)*c:c<.5?b:c<2/3?a+(b-a)*(2/3-c)*6:a};if(0===b)d=e=f=c;else{var h=c<.5?c*(1+b):c+b-c*b,i=2*c-h;d=g(i,h,a+1/3),e=g(i,h,a),f=g(i,h,a-1/3)}return[Math.floor(255*d),Math.floor(255*e),Math.floor(255*f)]},setRGB:function(a,b,c){return this._rgb=[a,b,c],this._hsl=this.rgbToHSL(a,b,c),this},setHSL:function(a,b,c){return this._hsl=[a,b,c],this._rgb=this.hslToRGB(a,b,c),this},toHSL:function(){return this._hsl},toHSLString:function(){var a="hsl";return this._a<1&&(a+="a"),a+"("+(360*this._hsl[0]).toFixed(1)+","+(100*this._hsl[1]).toFixed(0)+"%,"+(100*this._hsl[2]).toFixed(0)+"%)"},toRGB:function(){return this._rgb},toRGBString:function(){var a;if(this._a<1)a="rgba("+this._rgb[0].toFixed(0)+","+this._rgb[1].toFixed(0)+","+this._rgb[2].toFixed(0)+","+this._a.toFixed(1)+")";else{for(var b=[this._rgb[0].toString(16),this._rgb[1].toString(16),this._rgb[2].toString(16)],c=0,d=b.length;c<d;++c)1===b[c].length&&(b[c]="0"+b[c]);a="#"+b.join("")}return a},r:function(a){return arguments.length?this.setRGB(a,this._rgb[1],this._rgb[2]):this._rgb[0]},g:function(a){return arguments.length?this.setRGB(this._rgb[0],a,this._rgb[2]):this._rgb[1]},b:function(a){return arguments.length?this.setRGB(this._rgb[0],this._rgb[1],a):this._rgb[2]},h:function(a){return arguments.length?this.setHSL(a,this._hsl[1],this._hsl[2]):this._hsl[0]},s:function(a){return arguments.length?this.setHSL(this._hsl[0],a,this._hsl[2]):this._hsl[1]},l:function(a){return arguments.length?this.setHSL(this._hsl[0],this._hsl[1],a):this._hsl[2]},a:function(a){return arguments.length?(this._a=a,this):this._a}}),a.RGBColor=a.Color.extend({initialize:function(b){a.Color.prototype.initialize.call(this,b)},parseColorDef:function(a){var b,c,d,e,f=a instanceof Array,g=0===a.indexOf("#"),h=[];f?(b=Math.floor(a[0]),c=Math.floor(a[1]),d=Math.floor(a[2]),e=4===a.length?a[3]:1):g?(a=a.replace("#",""),b=parseInt(a.substring(0,2),16),c=parseInt(a.substring(2,4),16),d=parseInt(a.substring(4,6),16),e=8===a.length?parseInt(a.substring(6,8),16):1):(h=a.replace("rgb","").replace("a","").replace(/\s+/g,"").replace("(","").replace(")","").split(","),b=parseInt(h[0]),c=parseInt(h[1]),d=parseInt(h[2]),e=4===h.length?parseInt(h[3]):1),this.setRGB(b,c,d),this._a=e}}),a.rgbColor=function(b){return new a.RGBColor(b)},a.HSLColor=a.Color.extend({initialize:function(b){a.Color.prototype.initialize.call(this,b)},parseColorDef:function(a){var b,c,d,e,f=a instanceof Array;if(f)b=a[0],c=a[1],d=a[2],e=4===a.length?a[3]:1;else{var g=a.replace("hsl","").replace("a","").replace("(","").replace(/\s+/g,"").replace(/%/g,"").replace(")","").split(",");b=Number(g[0])/360,c=Number(g[1])/100,d=Number(g[2])/100,e=4===g.length?parseInt(g[3]):1}this.setHSL(b,c,d),this._a=e}}),a.hslColor=function(b){return new a.HSLColor(b)},a.Animation=a.Evented.extend({initialize:function(a,b){this._easeFunction=a,this._animateFrame=b},run:function(a,b){b=b||{},this.stop(),this._el=a,this._inProgress=!0,this._duration=b.duration||0,this._animationOptions=b,this._startTime=+new Date,this.fire("start"),this._animate()},stop:function(){this._inProgress&&(this._step(),this._complete())},_animate:function(){this._animId=a.Util.requestAnimFrame(this._animate,this),this._step()},_step:function(){var a=+new Date-this._startTime,b=1e3*this._duration;0===b||a<b?this._runFrame(this._easeFunction(a/(b||1))):(this._runFrame(1),this._complete())},_runFrame:function(a){this._animateFrame(a),this.fire("step")},_complete:function(){a.Util.cancelAnimFrame(this._animId),this._inProgress=!1,this.fire("end")}})},window),// @preserve This product includes color specifications and designs developed by Cynthia Brewer (http://colorbrewer.org/).
function(a,b){"function"==typeof define&&define.amd?define(["leaflet"],a):"object"==typeof exports&&(module.exports=a(require("leaflet"))),"undefined"!=typeof b&&b.L&&(b.L.YourPlugin=a(L))}(function(a){a.ColorBrewer={Sequential:{YlGn:{3:["#f7fcb9","#addd8e","#31a354"],4:["#ffffcc","#c2e699","#78c679","#238443"],5:["#ffffcc","#c2e699","#78c679","#31a354","#006837"],6:["#ffffcc","#d9f0a3","#addd8e","#78c679","#31a354","#006837"],7:["#ffffcc","#d9f0a3","#addd8e","#78c679","#41ab5d","#238443","#005a32"],8:["#ffffe5","#f7fcb9","#d9f0a3","#addd8e","#78c679","#41ab5d","#238443","#005a32"],9:["#ffffe5","#f7fcb9","#d9f0a3","#addd8e","#78c679","#41ab5d","#238443","#006837","#004529"]},YlGnBu:{3:["#edf8b1","#7fcdbb","#2c7fb8"],4:["#ffffcc","#a1dab4","#41b6c4","#225ea8"],5:["#ffffcc","#a1dab4","#41b6c4","#2c7fb8","#253494"],6:["#ffffcc","#c7e9b4","#7fcdbb","#41b6c4","#2c7fb8","#253494"],7:["#ffffcc","#c7e9b4","#7fcdbb","#41b6c4","#1d91c0","#225ea8","#0c2c84"],8:["#ffffd9","#edf8b1","#c7e9b4","#7fcdbb","#41b6c4","#1d91c0","#225ea8","#0c2c84"],9:["#ffffd9","#edf8b1","#c7e9b4","#7fcdbb","#41b6c4","#1d91c0","#225ea8","#253494","#081d58"]},GnBu:{3:["#e0f3db","#a8ddb5","#43a2ca"],4:["#f0f9e8","#bae4bc","#7bccc4","#2b8cbe"],5:["#f0f9e8","#bae4bc","#7bccc4","#43a2ca","#0868ac"],6:["#f0f9e8","#ccebc5","#a8ddb5","#7bccc4","#43a2ca","#0868ac"],7:["#f0f9e8","#ccebc5","#a8ddb5","#7bccc4","#4eb3d3","#2b8cbe","#08589e"],8:["#f7fcf0","#e0f3db","#ccebc5","#a8ddb5","#7bccc4","#4eb3d3","#2b8cbe","#08589e"],9:["#f7fcf0","#e0f3db","#ccebc5","#a8ddb5","#7bccc4","#4eb3d3","#2b8cbe","#0868ac","#084081"]},BuGn:{3:["#e5f5f9","#99d8c9","#2ca25f"],4:["#edf8fb","#b2e2e2","#66c2a4","#238b45"],5:["#edf8fb","#b2e2e2","#66c2a4","#2ca25f","#006d2c"],6:["#edf8fb","#ccece6","#99d8c9","#66c2a4","#2ca25f","#006d2c"],7:["#edf8fb","#ccece6","#99d8c9","#66c2a4","#41ae76","#238b45","#005824"],8:["#f7fcfd","#e5f5f9","#ccece6","#99d8c9","#66c2a4","#41ae76","#238b45","#005824"],9:["#f7fcfd","#e5f5f9","#ccece6","#99d8c9","#66c2a4","#41ae76","#238b45","#006d2c","#00441b"]},PuBuGn:{3:["#ece2f0","#a6bddb","#1c9099"],4:["#f6eff7","#bdc9e1","#67a9cf","#02818a"],5:["#f6eff7","#bdc9e1","#67a9cf","#1c9099","#016c59"],6:["#f6eff7","#d0d1e6","#a6bddb","#67a9cf","#1c9099","#016c59"],7:["#f6eff7","#d0d1e6","#a6bddb","#67a9cf","#3690c0","#02818a","#016450"],8:["#fff7fb","#ece2f0","#d0d1e6","#a6bddb","#67a9cf","#3690c0","#02818a","#016450"],9:["#fff7fb","#ece2f0","#d0d1e6","#a6bddb","#67a9cf","#3690c0","#02818a","#016c59","#014636"]},PuBu:{3:["#ece7f2","#a6bddb","#2b8cbe"],4:["#f1eef6","#bdc9e1","#74a9cf","#0570b0"],5:["#f1eef6","#bdc9e1","#74a9cf","#2b8cbe","#045a8d"],6:["#f1eef6","#d0d1e6","#a6bddb","#74a9cf","#2b8cbe","#045a8d"],7:["#f1eef6","#d0d1e6","#a6bddb","#74a9cf","#3690c0","#0570b0","#034e7b"],8:["#fff7fb","#ece7f2","#d0d1e6","#a6bddb","#74a9cf","#3690c0","#0570b0","#034e7b"],9:["#fff7fb","#ece7f2","#d0d1e6","#a6bddb","#74a9cf","#3690c0","#0570b0","#045a8d","#023858"]},BuPu:{3:["#e0ecf4","#9ebcda","#8856a7"],4:["#edf8fb","#b3cde3","#8c96c6","#88419d"],5:["#edf8fb","#b3cde3","#8c96c6","#8856a7","#810f7c"],6:["#edf8fb","#bfd3e6","#9ebcda","#8c96c6","#8856a7","#810f7c"],7:["#edf8fb","#bfd3e6","#9ebcda","#8c96c6","#8c6bb1","#88419d","#6e016b"],8:["#f7fcfd","#e0ecf4","#bfd3e6","#9ebcda","#8c96c6","#8c6bb1","#88419d","#6e016b"],9:["#f7fcfd","#e0ecf4","#bfd3e6","#9ebcda","#8c96c6","#8c6bb1","#88419d","#810f7c","#4d004b"]},RdPu:{3:["#fde0dd","#fa9fb5","#c51b8a"],4:["#feebe2","#fbb4b9","#f768a1","#ae017e"],5:["#feebe2","#fbb4b9","#f768a1","#c51b8a","#7a0177"],6:["#feebe2","#fcc5c0","#fa9fb5","#f768a1","#c51b8a","#7a0177"],7:["#feebe2","#fcc5c0","#fa9fb5","#f768a1","#dd3497","#ae017e","#7a0177"],8:["#fff7f3","#fde0dd","#fcc5c0","#fa9fb5","#f768a1","#dd3497","#ae017e","#7a0177"],9:["#fff7f3","#fde0dd","#fcc5c0","#fa9fb5","#f768a1","#dd3497","#ae017e","#7a0177","#49006a"]},PuRd:{3:["#e7e1ef","#c994c7","#dd1c77"],4:["#f1eef6","#d7b5d8","#df65b0","#ce1256"],5:["#f1eef6","#d7b5d8","#df65b0","#dd1c77","#980043"],6:["#f1eef6","#d4b9da","#c994c7","#df65b0","#dd1c77","#980043"],7:["#f1eef6","#d4b9da","#c994c7","#df65b0","#e7298a","#ce1256","#91003f"],8:["#f7f4f9","#e7e1ef","#d4b9da","#c994c7","#df65b0","#e7298a","#ce1256","#91003f"],9:["#f7f4f9","#e7e1ef","#d4b9da","#c994c7","#df65b0","#e7298a","#ce1256","#980043","#67001f"]},OrRd:{3:["#fee8c8","#fdbb84","#e34a33"],4:["#fef0d9","#fdcc8a","#fc8d59","#d7301f"],5:["#fef0d9","#fdcc8a","#fc8d59","#e34a33","#b30000"],6:["#fef0d9","#fdd49e","#fdbb84","#fc8d59","#e34a33","#b30000"],7:["#fef0d9","#fdd49e","#fdbb84","#fc8d59","#ef6548","#d7301f","#990000"],8:["#fff7ec","#fee8c8","#fdd49e","#fdbb84","#fc8d59","#ef6548","#d7301f","#990000"],9:["#fff7ec","#fee8c8","#fdd49e","#fdbb84","#fc8d59","#ef6548","#d7301f","#b30000","#7f0000"]},YlOrRd:{3:["#ffeda0","#feb24c","#f03b20"],4:["#ffffb2","#fecc5c","#fd8d3c","#e31a1c"],5:["#ffffb2","#fecc5c","#fd8d3c","#f03b20","#bd0026"],6:["#ffffb2","#fed976","#feb24c","#fd8d3c","#f03b20","#bd0026"],7:["#ffffb2","#fed976","#feb24c","#fd8d3c","#fc4e2a","#e31a1c","#b10026"],8:["#ffffcc","#ffeda0","#fed976","#feb24c","#fd8d3c","#fc4e2a","#e31a1c","#b10026"],9:["#ffffcc","#ffeda0","#fed976","#feb24c","#fd8d3c","#fc4e2a","#e31a1c","#bd0026","#800026"]},YlOrBr:{3:["#fff7bc","#fec44f","#d95f0e"],4:["#ffffd4","#fed98e","#fe9929","#cc4c02"],5:["#ffffd4","#fed98e","#fe9929","#d95f0e","#993404"],6:["#ffffd4","#fee391","#fec44f","#fe9929","#d95f0e","#993404"],7:["#ffffd4","#fee391","#fec44f","#fe9929","#ec7014","#cc4c02","#8c2d04"],8:["#ffffe5","#fff7bc","#fee391","#fec44f","#fe9929","#ec7014","#cc4c02","#8c2d04"],9:["#ffffe5","#fff7bc","#fee391","#fec44f","#fe9929","#ec7014","#cc4c02","#993404","#662506"]},Purples:{3:["#efedf5","#bcbddc","#756bb1"],4:["#f2f0f7","#cbc9e2","#9e9ac8","#6a51a3"],5:["#f2f0f7","#cbc9e2","#9e9ac8","#756bb1","#54278f"],6:["#f2f0f7","#dadaeb","#bcbddc","#9e9ac8","#756bb1","#54278f"],7:["#f2f0f7","#dadaeb","#bcbddc","#9e9ac8","#807dba","#6a51a3","#4a1486"],8:["#fcfbfd","#efedf5","#dadaeb","#bcbddc","#9e9ac8","#807dba","#6a51a3","#4a1486"],9:["#fcfbfd","#efedf5","#dadaeb","#bcbddc","#9e9ac8","#807dba","#6a51a3","#54278f","#3f007d"]},Blues:{3:["#deebf7","#9ecae1","#3182bd"],4:["#eff3ff","#bdd7e7","#6baed6","#2171b5"],5:["#eff3ff","#bdd7e7","#6baed6","#3182bd","#08519c"],6:["#eff3ff","#c6dbef","#9ecae1","#6baed6","#3182bd","#08519c"],7:["#eff3ff","#c6dbef","#9ecae1","#6baed6","#4292c6","#2171b5","#084594"],8:["#f7fbff","#deebf7","#c6dbef","#9ecae1","#6baed6","#4292c6","#2171b5","#084594"],9:["#f7fbff","#deebf7","#c6dbef","#9ecae1","#6baed6","#4292c6","#2171b5","#08519c","#08306b"]},Greens:{3:["#e5f5e0","#a1d99b","#31a354"],4:["#edf8e9","#bae4b3","#74c476","#238b45"],5:["#edf8e9","#bae4b3","#74c476","#31a354","#006d2c"],6:["#edf8e9","#c7e9c0","#a1d99b","#74c476","#31a354","#006d2c"],7:["#edf8e9","#c7e9c0","#a1d99b","#74c476","#41ab5d","#238b45","#005a32"],8:["#f7fcf5","#e5f5e0","#c7e9c0","#a1d99b","#74c476","#41ab5d","#238b45","#005a32"],9:["#f7fcf5","#e5f5e0","#c7e9c0","#a1d99b","#74c476","#41ab5d","#238b45","#006d2c","#00441b"]},Oranges:{3:["#fee6ce","#fdae6b","#e6550d"],4:["#feedde","#fdbe85","#fd8d3c","#d94701"],5:["#feedde","#fdbe85","#fd8d3c","#e6550d","#a63603"],6:["#feedde","#fdd0a2","#fdae6b","#fd8d3c","#e6550d","#a63603"],7:["#feedde","#fdd0a2","#fdae6b","#fd8d3c","#f16913","#d94801","#8c2d04"],8:["#fff5eb","#fee6ce","#fdd0a2","#fdae6b","#fd8d3c","#f16913","#d94801","#8c2d04"],9:["#fff5eb","#fee6ce","#fdd0a2","#fdae6b","#fd8d3c","#f16913","#d94801","#a63603","#7f2704"]},Reds:{3:["#fee0d2","#fc9272","#de2d26"],4:["#fee5d9","#fcae91","#fb6a4a","#cb181d"],5:["#fee5d9","#fcae91","#fb6a4a","#de2d26","#a50f15"],6:["#fee5d9","#fcbba1","#fc9272","#fb6a4a","#de2d26","#a50f15"],7:["#fee5d9","#fcbba1","#fc9272","#fb6a4a","#ef3b2c","#cb181d","#99000d"],8:["#fff5f0","#fee0d2","#fcbba1","#fc9272","#fb6a4a","#ef3b2c","#cb181d","#99000d"],9:["#fff5f0","#fee0d2","#fcbba1","#fc9272","#fb6a4a","#ef3b2c","#cb181d","#a50f15","#67000d"]},Greys:{3:["#f0f0f0","#bdbdbd","#636363"],4:["#f7f7f7","#cccccc","#969696","#525252"],5:["#f7f7f7","#cccccc","#969696","#636363","#252525"],6:["#f7f7f7","#d9d9d9","#bdbdbd","#969696","#636363","#252525"],7:["#f7f7f7","#d9d9d9","#bdbdbd","#969696","#737373","#525252","#252525"],8:["#ffffff","#f0f0f0","#d9d9d9","#bdbdbd","#969696","#737373","#525252","#252525"],9:["#ffffff","#f0f0f0","#d9d9d9","#bdbdbd","#969696","#737373","#525252","#252525","#000000"]}},Diverging:{PuOr:{3:["#f1a340","#f7f7f7","#998ec3"],4:["#e66101","#fdb863","#b2abd2","#5e3c99"],5:["#e66101","#fdb863","#f7f7f7","#b2abd2","#5e3c99"],6:["#b35806","#f1a340","#fee0b6","#d8daeb","#998ec3","#542788"],7:["#b35806","#f1a340","#fee0b6","#f7f7f7","#d8daeb","#998ec3","#542788"],8:["#b35806","#e08214","#fdb863","#fee0b6","#d8daeb","#b2abd2","#8073ac","#542788"],9:["#b35806","#e08214","#fdb863","#fee0b6","#f7f7f7","#d8daeb","#b2abd2","#8073ac","#542788"],10:["#7f3b08","#b35806","#e08214","#fdb863","#fee0b6","#d8daeb","#b2abd2","#8073ac","#542788","#2d004b"],11:["#7f3b08","#b35806","#e08214","#fdb863","#fee0b6","#f7f7f7","#d8daeb","#b2abd2","#8073ac","#542788","#2d004b"]},BrBG:{3:["#d8b365","#f5f5f5","#5ab4ac"],4:["#a6611a","#dfc27d","#80cdc1","#018571"],5:["#a6611a","#dfc27d","#f5f5f5","#80cdc1","#018571"],6:["#8c510a","#d8b365","#f6e8c3","#c7eae5","#5ab4ac","#01665e"],7:["#8c510a","#d8b365","#f6e8c3","#f5f5f5","#c7eae5","#5ab4ac","#01665e"],8:["#8c510a","#bf812d","#dfc27d","#f6e8c3","#c7eae5","#80cdc1","#35978f","#01665e"],9:["#8c510a","#bf812d","#dfc27d","#f6e8c3","#f5f5f5","#c7eae5","#80cdc1","#35978f","#01665e"],10:["#543005","#8c510a","#bf812d","#dfc27d","#f6e8c3","#c7eae5","#80cdc1","#35978f","#01665e","#003c30"],11:["#543005","#8c510a","#bf812d","#dfc27d","#f6e8c3","#f5f5f5","#c7eae5","#80cdc1","#35978f","#01665e","#003c30"]},PRGn:{3:["#af8dc3","#f7f7f7","#7fbf7b"],4:["#7b3294","#c2a5cf","#a6dba0","#008837"],5:["#7b3294","#c2a5cf","#f7f7f7","#a6dba0","#008837"],6:["#762a83","#af8dc3","#e7d4e8","#d9f0d3","#7fbf7b","#1b7837"],7:["#762a83","#af8dc3","#e7d4e8","#f7f7f7","#d9f0d3","#7fbf7b","#1b7837"],8:["#762a83","#9970ab","#c2a5cf","#e7d4e8","#d9f0d3","#a6dba0","#5aae61","#1b7837"],9:["#762a83","#9970ab","#c2a5cf","#e7d4e8","#f7f7f7","#d9f0d3","#a6dba0","#5aae61","#1b7837"],10:["#40004b","#762a83","#9970ab","#c2a5cf","#e7d4e8","#d9f0d3","#a6dba0","#5aae61","#1b7837","#00441b"],11:["#40004b","#762a83","#9970ab","#c2a5cf","#e7d4e8","#f7f7f7","#d9f0d3","#a6dba0","#5aae61","#1b7837","#00441b"]},PiYG:{3:["#e9a3c9","#f7f7f7","#a1d76a"],4:["#d01c8b","#f1b6da","#b8e186","#4dac26"],5:["#d01c8b","#f1b6da","#f7f7f7","#b8e186","#4dac26"],6:["#c51b7d","#e9a3c9","#fde0ef","#e6f5d0","#a1d76a","#4d9221"],7:["#c51b7d","#e9a3c9","#fde0ef","#f7f7f7","#e6f5d0","#a1d76a","#4d9221"],8:["#c51b7d","#de77ae","#f1b6da","#fde0ef","#e6f5d0","#b8e186","#7fbc41","#4d9221"],9:["#c51b7d","#de77ae","#f1b6da","#fde0ef","#f7f7f7","#e6f5d0","#b8e186","#7fbc41","#4d9221"],10:["#8e0152","#c51b7d","#de77ae","#f1b6da","#fde0ef","#e6f5d0","#b8e186","#7fbc41","#4d9221","#276419"],11:["#8e0152","#c51b7d","#de77ae","#f1b6da","#fde0ef","#f7f7f7","#e6f5d0","#b8e186","#7fbc41","#4d9221","#276419"]},RdBu:{3:["#ef8a62","#f7f7f7","#67a9cf"],4:["#ca0020","#f4a582","#92c5de","#0571b0"],5:["#ca0020","#f4a582","#f7f7f7","#92c5de","#0571b0"],6:["#b2182b","#ef8a62","#fddbc7","#d1e5f0","#67a9cf","#2166ac"],7:["#b2182b","#ef8a62","#fddbc7","#f7f7f7","#d1e5f0","#67a9cf","#2166ac"],8:["#b2182b","#d6604d","#f4a582","#fddbc7","#d1e5f0","#92c5de","#4393c3","#2166ac"],9:["#b2182b","#d6604d","#f4a582","#fddbc7","#f7f7f7","#d1e5f0","#92c5de","#4393c3","#2166ac"],10:["#67001f","#b2182b","#d6604d","#f4a582","#fddbc7","#d1e5f0","#92c5de","#4393c3","#2166ac","#053061"],11:["#67001f","#b2182b","#d6604d","#f4a582","#fddbc7","#f7f7f7","#d1e5f0","#92c5de","#4393c3","#2166ac","#053061"]},RdGy:{3:["#ef8a62","#ffffff","#999999"],4:["#ca0020","#f4a582","#bababa","#404040"],5:["#ca0020","#f4a582","#ffffff","#bababa","#404040"],6:["#b2182b","#ef8a62","#fddbc7","#e0e0e0","#999999","#4d4d4d"],7:["#b2182b","#ef8a62","#fddbc7","#ffffff","#e0e0e0","#999999","#4d4d4d"],8:["#b2182b","#d6604d","#f4a582","#fddbc7","#e0e0e0","#bababa","#878787","#4d4d4d"],9:["#b2182b","#d6604d","#f4a582","#fddbc7","#ffffff","#e0e0e0","#bababa","#878787","#4d4d4d"],10:["#67001f","#b2182b","#d6604d","#f4a582","#fddbc7","#e0e0e0","#bababa","#878787","#4d4d4d","#1a1a1a"],11:["#67001f","#b2182b","#d6604d","#f4a582","#fddbc7","#ffffff","#e0e0e0","#bababa","#878787","#4d4d4d","#1a1a1a"]},RdYlBu:{3:["#fc8d59","#ffffbf","#91bfdb"],4:["#d7191c","#fdae61","#abd9e9","#2c7bb6"],5:["#d7191c","#fdae61","#ffffbf","#abd9e9","#2c7bb6"],6:["#d73027","#fc8d59","#fee090","#e0f3f8","#91bfdb","#4575b4"],7:["#d73027","#fc8d59","#fee090","#ffffbf","#e0f3f8","#91bfdb","#4575b4"],8:["#d73027","#f46d43","#fdae61","#fee090","#e0f3f8","#abd9e9","#74add1","#4575b4"],9:["#d73027","#f46d43","#fdae61","#fee090","#ffffbf","#e0f3f8","#abd9e9","#74add1","#4575b4"],10:["#a50026","#d73027","#f46d43","#fdae61","#fee090","#e0f3f8","#abd9e9","#74add1","#4575b4","#313695"],11:["#a50026","#d73027","#f46d43","#fdae61","#fee090","#ffffbf","#e0f3f8","#abd9e9","#74add1","#4575b4","#313695"]},Spectral:{3:["#fc8d59","#ffffbf","#99d594"],4:["#d7191c","#fdae61","#abdda4","#2b83ba"],5:["#d7191c","#fdae61","#ffffbf","#abdda4","#2b83ba"],6:["#d53e4f","#fc8d59","#fee08b","#e6f598","#99d594","#3288bd"],7:["#d53e4f","#fc8d59","#fee08b","#ffffbf","#e6f598","#99d594","#3288bd"],8:["#d53e4f","#f46d43","#fdae61","#fee08b","#e6f598","#abdda4","#66c2a5","#3288bd"],9:["#d53e4f","#f46d43","#fdae61","#fee08b","#ffffbf","#e6f598","#abdda4","#66c2a5","#3288bd"],10:["#9e0142","#d53e4f","#f46d43","#fdae61","#fee08b","#e6f598","#abdda4","#66c2a5","#3288bd","#5e4fa2"],11:["#9e0142","#d53e4f","#f46d43","#fdae61","#fee08b","#ffffbf","#e6f598","#abdda4","#66c2a5","#3288bd","#5e4fa2"]},RdYlGn:{3:["#fc8d59","#ffffbf","#91cf60"],4:["#d7191c","#fdae61","#a6d96a","#1a9641"],5:["#d7191c","#fdae61","#ffffbf","#a6d96a","#1a9641"],6:["#d73027","#fc8d59","#fee08b","#d9ef8b","#91cf60","#1a9850"],7:["#d73027","#fc8d59","#fee08b","#ffffbf","#d9ef8b","#91cf60","#1a9850"],8:["#d73027","#f46d43","#fdae61","#fee08b","#d9ef8b","#a6d96a","#66bd63","#1a9850"],9:["#d73027","#f46d43","#fdae61","#fee08b","#ffffbf","#d9ef8b","#a6d96a","#66bd63","#1a9850"],10:["#a50026","#d73027","#f46d43","#fdae61","#fee08b","#d9ef8b","#a6d96a","#66bd63","#1a9850","#006837"],11:["#a50026","#d73027","#f46d43","#fdae61","#fee08b","#ffffbf","#d9ef8b","#a6d96a","#66bd63","#1a9850","#006837"]}},Qualitative:{Accent:{3:["#7fc97f","#beaed4","#fdc086"],4:["#7fc97f","#beaed4","#fdc086","#ffff99"],5:["#7fc97f","#beaed4","#fdc086","#ffff99","#386cb0"],6:["#7fc97f","#beaed4","#fdc086","#ffff99","#386cb0","#f0027f"],7:["#7fc97f","#beaed4","#fdc086","#ffff99","#386cb0","#f0027f","#bf5b17"],8:["#7fc97f","#beaed4","#fdc086","#ffff99","#386cb0","#f0027f","#bf5b17","#666666"]},Dark2:{3:["#1b9e77","#d95f02","#7570b3"],4:["#1b9e77","#d95f02","#7570b3","#e7298a"],5:["#1b9e77","#d95f02","#7570b3","#e7298a","#66a61e"],6:["#1b9e77","#d95f02","#7570b3","#e7298a","#66a61e","#e6ab02"],7:["#1b9e77","#d95f02","#7570b3","#e7298a","#66a61e","#e6ab02","#a6761d"],8:["#1b9e77","#d95f02","#7570b3","#e7298a","#66a61e","#e6ab02","#a6761d","#666666"]},Paired:{3:["#a6cee3","#1f78b4","#b2df8a"],4:["#a6cee3","#1f78b4","#b2df8a","#33a02c"],5:["#a6cee3","#1f78b4","#b2df8a","#33a02c","#fb9a99"],6:["#a6cee3","#1f78b4","#b2df8a","#33a02c","#fb9a99","#e31a1c"],7:["#a6cee3","#1f78b4","#b2df8a","#33a02c","#fb9a99","#e31a1c","#fdbf6f"],8:["#a6cee3","#1f78b4","#b2df8a","#33a02c","#fb9a99","#e31a1c","#fdbf6f","#ff7f00"],9:["#a6cee3","#1f78b4","#b2df8a","#33a02c","#fb9a99","#e31a1c","#fdbf6f","#ff7f00","#cab2d6"],10:["#a6cee3","#1f78b4","#b2df8a","#33a02c","#fb9a99","#e31a1c","#fdbf6f","#ff7f00","#cab2d6","#6a3d9a"],11:["#a6cee3","#1f78b4","#b2df8a","#33a02c","#fb9a99","#e31a1c","#fdbf6f","#ff7f00","#cab2d6","#6a3d9a","#ffff99"],12:["#a6cee3","#1f78b4","#b2df8a","#33a02c","#fb9a99","#e31a1c","#fdbf6f","#ff7f00","#cab2d6","#6a3d9a","#ffff99","#b15928"]},Pastel1:{3:["#fbb4ae","#b3cde3","#ccebc5"],4:["#fbb4ae","#b3cde3","#ccebc5","#decbe4"],5:["#fbb4ae","#b3cde3","#ccebc5","#decbe4","#fed9a6"],6:["#fbb4ae","#b3cde3","#ccebc5","#decbe4","#fed9a6","#ffffcc"],7:["#fbb4ae","#b3cde3","#ccebc5","#decbe4","#fed9a6","#ffffcc","#e5d8bd"],8:["#fbb4ae","#b3cde3","#ccebc5","#decbe4","#fed9a6","#ffffcc","#e5d8bd","#fddaec"],9:["#fbb4ae","#b3cde3","#ccebc5","#decbe4","#fed9a6","#ffffcc","#e5d8bd","#fddaec","#f2f2f2"]},Pastel2:{3:["#b3e2cd","#fdcdac","#cbd5e8"],4:["#b3e2cd","#fdcdac","#cbd5e8","#f4cae4"],5:["#b3e2cd","#fdcdac","#cbd5e8","#f4cae4","#e6f5c9"],6:["#b3e2cd","#fdcdac","#cbd5e8","#f4cae4","#e6f5c9","#fff2ae"],7:["#b3e2cd","#fdcdac","#cbd5e8","#f4cae4","#e6f5c9","#fff2ae","#f1e2cc"],8:["#b3e2cd","#fdcdac","#cbd5e8","#f4cae4","#e6f5c9","#fff2ae","#f1e2cc","#cccccc"]},Set1:{3:["#e41a1c","#377eb8","#4daf4a"],4:["#e41a1c","#377eb8","#4daf4a","#984ea3"],5:["#e41a1c","#377eb8","#4daf4a","#984ea3","#ff7f00"],6:["#e41a1c","#377eb8","#4daf4a","#984ea3","#ff7f00","#ffff33"],7:["#e41a1c","#377eb8","#4daf4a","#984ea3","#ff7f00","#ffff33","#a65628"],8:["#e41a1c","#377eb8","#4daf4a","#984ea3","#ff7f00","#ffff33","#a65628","#f781bf"],9:["#e41a1c","#377eb8","#4daf4a","#984ea3","#ff7f00","#ffff33","#a65628","#f781bf","#999999"]},Set2:{3:["#66c2a5","#fc8d62","#8da0cb"],4:["#66c2a5","#fc8d62","#8da0cb","#e78ac3"],5:["#66c2a5","#fc8d62","#8da0cb","#e78ac3","#a6d854"],6:["#66c2a5","#fc8d62","#8da0cb","#e78ac3","#a6d854","#ffd92f"],7:["#66c2a5","#fc8d62","#8da0cb","#e78ac3","#a6d854","#ffd92f","#e5c494"],8:["#66c2a5","#fc8d62","#8da0cb","#e78ac3","#a6d854","#ffd92f","#e5c494","#b3b3b3"]},Set3:{3:["#8dd3c7","#ffffb3","#bebada"],4:["#8dd3c7","#ffffb3","#bebada","#fb8072"],5:["#8dd3c7","#ffffb3","#bebada","#fb8072","#80b1d3"],6:["#8dd3c7","#ffffb3","#bebada","#fb8072","#80b1d3","#fdb462"],7:["#8dd3c7","#ffffb3","#bebada","#fb8072","#80b1d3","#fdb462","#b3de69"],8:["#8dd3c7","#ffffb3","#bebada","#fb8072","#80b1d3","#fdb462","#b3de69","#fccde5"],9:["#8dd3c7","#ffffb3","#bebada","#fb8072","#80b1d3","#fdb462","#b3de69","#fccde5","#d9d9d9"],10:["#8dd3c7","#ffffb3","#bebada","#fb8072","#80b1d3","#fdb462","#b3de69","#fccde5","#d9d9d9","#bc80bd"],11:["#8dd3c7","#ffffb3","#bebada","#fb8072","#80b1d3","#fdb462","#b3de69","#fccde5","#d9d9d9","#bc80bd","#ccebc5"],12:["#8dd3c7","#ffffb3","#bebada","#fb8072","#80b1d3","#fdb462","#b3de69","#fccde5","#d9d9d9","#bc80bd","#ccebc5","#ffed6f"]}}},a.Palettes={huePalette:function(b,c,d,e,f){return new a.HSLHueFunction(new a.Point(b,d),new a.Point(c,e),f)},luminosityPalette:function(b,c,d,e,f){return new a.HSLLuminosityFunction(new a.Point(b,d),new a.Point(c,e),f)},saturationPalette:function(b,c,d,e,f){return new a.HSLSaturationFunction(new a.Point(b,d),new a.Point(c,e),f)},rgbBlendPalette:function(b,c,d,e,f){return new a.RGBColorBlendFunction(b,c,d,e,f)},hslBlendPalette:function(b,c,d,e,f){return new a.HSLColorBlendFunction(b,c,d,e,f)},customColorPalette:function(b,c,d,e){return new a.CustomColorFunction(b,c,d,e)}},a.DynamicColorPalettes={rainbow:{text:"Rainbow",getPalette:function(b,c,d){return a.Palettes.huePalette(b,c,0,300,d)}},greentored:{text:"Green - Red",getPalette:function(b,c,d){return a.Palettes.huePalette(b,c,120,0,d)}},yellowtored:{text:"Yellow - Red",getPalette:function(b,c,d){return a.Palettes.huePalette(b,c,60,0,d)}},orangetored:{text:"Orange - Red",getPalette:function(b,c,d){return a.Palettes.huePalette(b,c,30,0,d)}},redtopurple:{text:"Red - Purple",getPalette:function(b,c,d){return a.Palettes.huePalette(b,c,360,270,d)}},bluetored:{text:"Blue - Red",getPalette:function(b,c,d){return a.Palettes.huePalette(b,c,210,360,d)}},bluetored2:{text:"Blue - Red 2",getPalette:function(b,c,d){return a.Palettes.huePalette(b,c,180,0,d)}},whitetored:{text:"White - Red",getPalette:function(b,c,d){return a.Palettes.luminosityPalette(b,c,1,.5,a.Util.extend(option,{outputHue:0}))}},whitetoorange:{text:"White - Orange",getPalette:function(b,c,d){return a.Palettes.luminosityPalette(b,c,1,.5,a.Util.extend(option,{outputHue:30}))}},whitetoyellow:{text:"White - Yellow",getPalette:function(b,c,d){return a.Palettes.luminosityPalette(b,c,1,.5,a.Util.extend(option,{outputHue:60}))}},whitetogreen:{text:"White - Green",getPalette:function(b,c,d){return a.Palettes.luminosityPalette(b,c,1,.5,a.Util.extend(option,{outputHue:120}))}},whitetoltblue:{text:"White - Lt. Blue",getPalette:function(b,c,d){return a.Palettes.luminosityPalette(b,c,1,.5,a.Util.extend(option,{outputHue:180}))}},whitetoblue:{text:"White - Blue",getPalette:function(b,c,d){return a.Palettes.luminosityPalette(b,c,1,.5,a.Util.extend(option,{outputHue:240}))}},whitetopurple:{text:"White - Purple",getPalette:function(b,c,d){return a.Palettes.luminosityPalette(b,c,1,.5,a.Util.extend(option,{outputHue:270}))}},graytored:{text:"Gray - Red",getPalette:function(b,c,d){return a.Palettes.saturationPalette(b,c,0,1,a.Util.extend(option,{outputHue:0}))}},graytoorange:{text:"Gray - Orange",getPalette:function(b,c,d){return a.Palettes.saturationPalette(b,c,0,1,a.Util.extend(option,{outputHue:30}))}},graytoyellow:{text:"Gray - Yellow",getPalette:function(b,c,d){return a.Palettes.saturationPalette(b,c,0,1,a.Util.extend(option,{outputHue:60}))}},graytogreen:{text:"Gray - Green",getPalette:function(b,c,d){return a.Palettes.saturationPalette(b,c,0,1,a.Util.extend(option,{outputHue:120}))}},graytoltblue:{text:"Gray - Lt. Blue",getPalette:function(b,c,d){return a.Palettes.saturationPalette(b,c,0,1,a.Util.extend(option,{outputHue:180}))}},graytoblue:{text:"Gray - Blue",getPalette:function(b,c,d){return a.Palettes.saturationPalette(b,c,0,1,a.Util.extend(option,{outputHue:240}))}},graytopurple:{text:"Gray - Purple",getPalette:function(b,c,d){return a.Palettes.saturationPalette(b,c,0,1,a.Util.extend(option,{outputHue:270}))}}},a.DynamicPaletteElement=a.Class.extend({initialize:function(a,b){this._key=a,this._dynamicPalette=b},generate:function(b){var c=a.DomUtil.create("div","palette"),d=b.count,e=this._dynamicPalette.getPalette(0,d-1),f=b.width,g=!0;b.showText&&(g=b.showText),c.setAttribute("data-palette-key",this._key),this._dynamicPalette.text&&g&&(a.DomUtil.create("div","palette-text",c).innerHTML='<i class="icon-ok hidden"></i>'+this._dynamicPalette.text);var h=f/d;b.className&&a.DomUtil.addClass(c,b.className);for(var i=0;i<d;++i){var j=a.DomUtil.create("i","palette-element");for(var k in e){var l=e[k],m=l.evaluate?l.evaluate(i):l;a.StyleConverter.setCSSProperty(j,k,m)}j.style.width=h+"px",c.appendChild(j)}return c}})},window),function(a,b){"function"==typeof define&&define.amd?define(["leaflet"],a):"object"==typeof exports&&(module.exports=a(require("leaflet"))),"undefined"!=typeof b&&b.L&&(b.L.YourPlugin=a(L))}(function(a){a.RegularPolygon=a.Polygon.extend({statics:{R:6378.137,M_PER_KM:1e3},initialize:function(b,c){this._centerLatLng=b,a.setOptions(this,c),a.Polygon.prototype.initialize.call(this,this._getLatLngs(),c)},options:{fill:!0,radius:1e3,numberOfSides:4,rotation:0,maxDegrees:360},getLatLng:function(){return this._centerLatLng},setRadius:function(a){this.options.radius=a,this._latlngs=this._getLatLngs(),this.redraw()},_getLatLngs:function(){for(var a,b=this.options.maxDegrees||360,c=b/Math.max(this.options.numberOfSides,3),d=b+this.options.rotation,e=this.options.rotation,f=[];e<d;)a=this._getPoint(e),f.push(a),e+=c;return f},_getPoint:function(b){var c=function(b){return b*a.LatLng.DEG_TO_RAD},d=function(b){return b*a.LatLng.RAD_TO_DEG},e=c(b),f=this.options.radius/a.RegularPolygon.M_PER_KM/a.RegularPolygon.R,g=c(this._centerLatLng.lat),h=c(this._centerLatLng.lng),i=Math.asin(Math.sin(g)*Math.cos(f)+Math.cos(g)*Math.sin(f)*Math.cos(e)),j=h+Math.atan2(Math.sin(e)*Math.sin(f)*Math.cos(g),Math.cos(f)-Math.sin(g)*Math.sin(i));return i=d(i),j=d(j),new a.LatLng(i,j)},toGeoJSON:function(){for(var a={type:"Feature",geometry:{type:"Polygon",coordinates:[[],[]]},properties:this.options},b=0;b<this._latlngs.length;++b){var c=this._latlngs[b];a.geometry.coordinates[0].push([c.lng,c.lat])}return a}}),a.regularPolygon=function(b,c){return new a.RegularPolygon(b,c)}},window),function(a,b){"function"==typeof define&&define.amd?define(["leaflet"],a):"object"==typeof exports&&(module.exports=a(require("leaflet"))),"undefined"!=typeof b&&b.L&&(b.L.YourPlugin=a(L))}(function(a){a.Path.XLINK_NS="http://www.w3.org/1999/xlink";var b=b||{setStyle:function(a,b){var c="";for(var d in b)c+=d+": "+b[d]+";";return a.setAttribute("style",c),a},setAttr:function(a,b){for(var c in b)a.setAttribute(c,b[c]);return a}};a.extend(a.DomUtil,b);var c=c||{__addPath:a.SVG.prototype._addPath,_addPath:function(a){c.__addPath.call(this,a),a.options.text&&this._createText(a)},__removePath:a.SVG.prototype._removePath,_removePath:function(b){this.__removePath.call(this,b),b._text&&a.DomUtil.remove(b._text),b._pathDef&&a.DomUtil.remove(b._pathDef)},__updatePath:a.SVG.prototype._updatePath,_updatePath:function(a){this.__updatePath.call(this,a),a.options.text&&this._createText(a)},__setPath:a.SVG.prototype._setPath,_setPath:function(a,b){this.__setPath.call(this,a,b),a.options.text&&this._createText(a)},_initText:function(a){a.options.text&&this._createText(a)},getTextAnchor:function(a){if(a._point)return a._point},setTextAnchor:function(a,b){a._text&&(a._text.setAttribute("x",b.x),a._text.setAttribute("y",b.y))},_createText:function(b){var c=b.options.text||{};b._text&&(a.DomUtil.remove(b._text),b.text=null),b._pathDef&&(a.DomUtil.remove(b._pathDef),b._pathDef=null),b._text=a.SVG.create("text"),b._text.setAttribute("id",a.stamp(b._text));var d=document.createTextNode(c.text);if(c.path&&b._path){var e=c.path,f=a.SVG.create("path"),g=b._path.getAttribute("d");f.setAttribute("id",a.stamp(f)),g&&f.setAttribute("d",g),this._createDefs(),this._defs.appendChild(f),b._pathDef=f;var h=a.SVG.create("textPath");e.startOffset&&h.setAttribute("startOffset",e.startOffset),e.attr&&a.DomUtil.setAttr(h,e.attr),e.style&&a.DomUtil.setStyle(h,e.style),h.setAttributeNS(a.Path.XLINK_NS,"xlink:href","#"+a.stamp(f)),h.appendChild(d),b._text.appendChild(h)}else{b._text.appendChild(d),b._project();var i=b.getTextAnchor?b.getTextAnchor():this.getTextAnchor(b);this.setTextAnchor(b,i)}if(c.className?b._text.setAttribute("class",c.className):b._text.setAttribute("class","leaflet-svg-text"),c.attr&&a.DomUtil.setAttr(b._text,c.attr),c.style&&a.DomUtil.setStyle(b._text,c.style),b._path){var j=b._path.nextSibling;this._container.firstChild.insertBefore(b._text,j)}}},d=d||{__updateStyle:a.SVG.prototype._updateStyle,_finishPathAnimation:function(a,b){return function(){var c=a.options.dashArray||[0,0];a._path.style.strokeDasharray=c.join(" "),a._path.style.strokeDashoffset=0,b&&b(a)}},animatePath:function(b){var c=b._path,d=c.getTotalLength(),e=b.options.animatePath!==!0?a.extend({},b.options.animatePath):{},f=e.property||"stroke-dashoffset",g=e.duration||"2s",h=e.timingFunction||"ease-in-out",i=[f,g,h].join(" ");c.style.transition=c.style.MozTransition="none",c.style.transition=c.style.WebkitTransition="none",c.style.transition=c.style.MsTransition="none",c.style.strokeDasharray=d+" "+d,c.style.strokeDashoffset=d,c.getBoundingClientRect(),c.style.transition=c.style.MozTransition=i,c.style.transition=c.style.WebkitTransition=i,c.style.transition=c.style.MsTransition=i,c.style.strokeDashoffset="0",a.DomEvent.on(c,{transitionEnd:this._finishPathAnimation(b,e.animationEnd),mozTransitionEnd:this._finishPathAnimation(b,e.animationEnd),msTransitionEnd:this._finishPathAnimation(b,e.animationEnd),webkitTransitionEnd:this._finishPathAnimation(b,e.animationEnd),oTransitionEnd:this._finishPathAnimation(b,e.animationEnd)})},_createDefs:function(){this._defs||(this._defs=a.SVG.create("defs"),this._container.appendChild(this._defs))},_addPath:function(a){c._addPath.call(this,a),a._gradient&&this._defs.appendChild(a._gradient),a._dropShadow&&this._defs.appendChild(a._dropShadow),a._fillPattern&&this._defs.appendChild(a._fillPattern),a._shapePattern&&this._defs.appendChild(a._shapePattern),a._shape&&a._path&&this._container.firstChild.insertBefore(a._shape,a._path.nextSibling),a._pathDef&&this._defs.appendChild(a._pathDef),a.options.animatePath&&this.animatePath(a)},_updatePath:function(a){c._updatePath.call(this,a);var b=this;if(a.options.wordCloud){var d=a.options.wordCloud;d.words.length>0&&setTimeout(function(){b._createWordCloudPattern(a)},0)}},_removePath:function(b){c._removePath.call(this,b),b._gradient&&a.DomUtil.remove(b._gradient),b._dropShadow&&a.DomUtil.remove(b._dropShadow),b._fillPattern&&a.DomUtil.remove(b._fillPattern),b._shapePattern&&a.DomUtil.remove(b._shapePattern),b._shape&&a.DomUtil.remove(b._shape),b._g&&a.DomUtil.remove(b._g)},_createMarker:function(b,c,d){this._defs||this._createDefs(),b._markers=b._markers||{},b._markerPath=b._markerPath||{},b._markers[c]||(b._markers[c]=a.SVG.create("marker"),this._defs.appendChild(b._markers[c]));var e=a.Util.guid(),f=d.exaggeration||2,g=2*f;b._markers[c].setAttribute("id",e),b._markers[c].setAttribute("markerWidth",g),b._markers[c].setAttribute("markerHeight",g),b._markers[c].setAttribute("refX",f),b._markers[c].setAttribute("refY",f),b._markers[c].setAttribute("orient","auto"),b._markers[c].setAttribute("markerUnits","strokeWidth"),b._markerPath[c]||(b._markerPath[c]=a.SVG.create("path"),b._markers[c].appendChild(b._markerPath[c])),d.reverse?b._markerPath[c].setAttribute("d","M0,"+f+" L"+g+","+g+" L"+g+",0 L0,"+f):b._markerPath[c].setAttribute("d","M"+g+","+f+" L0,"+g+" L0,0 L"+g+","+f),b._markerPath[c].setAttribute("style","fill: "+b.options.color+"; opacity: "+b.options.opacity)},_createGradient:function(b){this._defs||this._createDefs();var c,d,e=b.options.gradient!==!0?a.extend({},b.options.gradient):{},f=e.gradientType||"linear";if(c=b._gradient||a.SVG.create(f+"Gradient"),"radial"===f)d=e.radial||{cx:"50%",cy:"50%",r:"50%",fx:"50%",fy:"50%"};else{var g=e.vector||[["0%","0%"],["100%","100%"]];d={x1:g[0][0],x2:g[1][0],y1:g[0][1],y2:g[1][1]}}d.id=c.id||a.stamp(c),e.gradientUnits&&c.setAttribute("gradientUnits",e.gradientUnits);var h,i=e.stops||[{offset:"0%",style:{color:"rgb(255, 255, 255)",opacity:1}},{offset:"60%",style:{color:b.options.fillColor||b.options.color,opacity:1}}];for(h in d)c.setAttribute(h,d[h]);for(var j=c.childNodes,k=j?j.length:0,l=0,m=i.length;l<m;++l){var n=i[l],o=k>l?j[l]:a.SVG.create("stop");n.style=n.style||{};for(h in n){var p=n[h];if("style"===h){var q="";p.color=p.color||b.options.fillColor||b.options.color,p.opacity="undefined"==typeof p.opacity?1:p.opacity;for(var r in p)q+="stop-"+r+":"+p[r]+";";p=q}o.setAttribute(h,p)}k<=l&&c.appendChild(o)}return b._gradient=c,d.id},_createDropShadow:function(b){this._createDefs();var c=b._dropShadow||a.SVG.create("filter"),d=c.querySelector("feOffset")||a.SVG.create("feOffset"),e=c.querySelector("feGaussianBlur")||a.SVG.create("feGaussianBlur"),f=c.querySelector("feBlend")||a.SVG.create("feBlend"),g=b.options.dropShadow&&"object"==typeof b.options.dropShadow&&Object.keys(b.options.dropShadow).length>0?b.options.dropShadow:{width:"200%",height:"200%"};g.id=a.stamp(c);for(var h in g)c.setAttribute(h,g[h]);var i={result:"offOut",in:"SourceAlpha",dx:"2",dy:"2"},j={result:"blurOut",in:"offOut",stdDeviation:"2"},k={in:"SourceGraphic",in2:"blurOut",mode:"lighten"};for(h in i)d.setAttribute(h,i[h]);for(h in j)e.setAttribute(h,j[h]);for(h in k)f.setAttribute(h,k[h]);return c.id=g.id,b._dropShadow||(c.appendChild(d),c.appendChild(e),c.appendChild(f)),b._dropShadow=c,a.stamp(c)},_createCustomElement:function(b,c){var d=a.SVG.create(b);d.setAttribute("id",a.stamp(d));for(var e in c)c.hasOwnProperty(e)&&d.setAttribute(e,c[e]);return d},_createImage:function(b){var c=a.SVG.create("image");return c.setAttribute("id",a.stamp(c)),c.setAttribute("width",b.width),c.setAttribute("height",b.height),c.setAttribute("x",b.x||0),c.setAttribute("y",b.y||0),c.setAttribute("preserveAspectRatio",b.preserveAspectRatio||"xMidYMid meet"),
c.setAttributeNS(a.Path.XLINK_NS,"xlink:href",b.url),c},_createPattern:function(b){var c=a.SVG.create("pattern");return c.setAttribute("id",a.stamp(c)),c.setAttribute("width",b.width),c.setAttribute("height",b.height),c.setAttribute("x",b.x||0),c.setAttribute("y",b.y||0),c.setAttribute("patternUnits",b.patternUnits||"objectBoundingBox"),c},_createShape:function(a,b){var c=this._createCustomElement(a,b);return c},_createFillPattern:function(b){this._createDefs();var c=a.extend({},b.options.fillPattern),d=this._createPattern(c.pattern),e=a.extend({url:c.url},c.image),f=this._createImage(e);return d.appendChild(f),b._fillPattern&&a.DomUtil.remove(b._fillPattern),b._fillPattern=d,a.stamp(d)},_getDefaultDiameter:function(a){return 1.75*a},_createShapeImage:function(b){this._createDefs();var c=b.options.shapeImage||{},d=b.options.radius||Math.max(b.options.radiusX,b.options.radiusY),e=b._getDefaultDiameter?b._getDefaultDiameter(d):this._getDefaultDiameter(d),f=c.imageSize||new a.Point(e,e),g=c.radius||e/2,h=c.shape||{circle:{r:g,cx:0,cy:0}},i=c.pattern||{width:f.x,height:f.y,x:0,y:0};i.patternUnits=i.patternUnits||"objectBoundingBox";var j=this._createPattern(i);a.stamp(j);var k=Object.keys(h),l=k.length>0?k[0]:"circle";h[l].fill="url(#"+a.stamp(j)+")";var m=this._createShape(l,h[l]);b.options.interactive&&m.setAttribute("class","leaflet-interactive"),c=c.image||{width:f.x,height:f.y,x:0,y:0,url:b.options.imageCircleUrl};var n=this._createImage(c);return n.setAttributeNS(a.Path.XLINK_NS,"xlink:href",c.url),j.appendChild(n),b._shapePattern&&a.DomUtil.remove(b._shapePattern),b._shape&&a.DomUtil.remove(b._shape),b._shapePattern=j,b._shape=m,a.stamp(j)},_updateStyle:function(a){this.__updateStyle.call(this,a);var b;if(a._path){if(a.options.text&&a._renderer._createText(a),a.options.markers)for(var c in a.options.markers)a.options.markers.hasOwnProperty(c)&&(this._createMarker(a,c,a.options.markers[c]),a._path.setAttribute("marker-"+c,"url(#"+a._markers[c].getAttribute("id")+")"));a.options.gradient?(b=this._createGradient(a),a.options.stroke&&!a.options.fill?a._path.setAttribute("stroke","url(#"+b+")"):a._path.setAttribute("fill","url(#"+b+")")):a.options.fill||a._path.setAttribute("fill","none"),a.options.dropShadow?(b=this._createDropShadow(a),a._path.setAttribute("filter","url(#"+b+")")):a._path.removeAttribute("filter"),a.options.fillPattern&&(b=this._createFillPattern(a),a._path.setAttribute("fill","url(#"+b+")"))}if(a._applyCustomStyles&&a._applyCustomStyles(),a._gradient&&this._defs.appendChild(a._gradient),a._dropShadow&&this._defs.appendChild(a._dropShadow),a._fillPattern&&this._defs.appendChild(a._fillPattern),a._shapePattern&&this._defs.appendChild(a._shapePattern),a._shape&&a._path&&this._container.firstChild.insertBefore(a._shape,a._path.nextSibling),a.options.wordCloud){var d=a.options.wordCloud,e=this;d.words.length>0&&setTimeout(function(){e._createWordCloudPattern(a)},0)}},_createWordCloudPattern:function(b){var c=b.options.wordCloud||{},d="",e=c.patternOptions||{};this._defs||this._createDefs(),c.textField=c.textField||"key",c.countField=c.countField||"doc_count";for(var f=0,g=c.words.length;f<g;++f){var h=c.words[f];d+=h[c.textField]+"_"+h[c.countField]}if(d!==b._wordCloudGuid&&b._path){b._wordCloudGuid=d;var i=a.SVG.create("path");i.setAttribute("d",b._path.getAttribute("d")),i.setAttribute("id",d),e.id=d,e.patternUnits=e.patternUnits||"userSpaceOnUse";var j=b.getBounds(),k=new a.Bounds(this._map.project(j.getNorthWest()),this._map.project(j.getSouthEast())),l=k.getSize().x/k.getSize().y;e.width=e.width||500,e.height=e.height||500*l||500,e.width=Math.min(e.width,e.height),e.height=e.width,b._wordCloud=a.SVG.create("g"),b._wordPattern=this._createPattern(e),b._wordPattern.id=d,b._wordPattern.appendChild(b._wordCloud),this._defs.appendChild(b._wordPattern),this._createWordCloud(b,b._wordCloud,c)}if(b._path){var m=b._path.getAttribute("fill");m.indexOf(b._wordCloudGuid)===-1&&b._path.setAttribute("fill","url(#"+b._wordCloudGuid+")")}},_createWordCloud:function(b,c,d){var e=d.patternOptions.width,f=d.patternOptions.height,g=d.words,h=(this.getTextAnchor(b),a.SVG.create("rect")),i=d.countField,j=d.textField,k=d.rotation||function(a){return 0};h.setAttribute("width",e),h.setAttribute("height",f),h.style.fill=b.options.fillColor||"#000",h.setAttribute("transform","translate("+-e/2+","+-f/2+")"),c.appendChild(h);var l=function(b,c){return function(b){"svg"+a.Util.guid();d3.select(c).attr("transform","translate("+e/2+","+f/2+")").selectAll("text").data(b).enter().append("text").style("font-size",function(a){return a.size+"px"}).style("font-family",d.fontFamily||"Impact").style("fill",function(a,b){return m(b)}).attr("text-anchor","middle").attr("transform",function(a){return"translate("+[a.x,a.y]+")rotate("+a.rotate+")"}).text(function(a){return a[j]})}},m=d.textFillColor||d3.scale.category20(),n=d3.scale.linear(),o=g[0][i],p=g[g.length-1][i],q=d.fontSize||d3.scale.log().domain([p,o]).range([10,40]);return n.domain([0,10]).range([-60,60]),d3.layout.cloud().size([e,f]).spiral("rectangular").timeInterval(1/0).words(g).padding(5).rotate(k).font(d.fontFamily||"Impact").fontSize(function(a){return q(a[i])}).on("end",l(g,c)).start(),c}},e={_getCenter:a.Polyline.prototype.getCenter,getCenter:function(){var a=this._getCenter.call(this);return a||(a=this._latlngs[0]),a},_buildDistanceIndex:function(){if(!this._index){var a=this._latlngs,b=0;this._index=[0];for(var c=0,d=a.length;c<d-1;++c)b+=a[c].distanceTo(a[c+1]),this._index.push(b);this._totalDistance=b}return this},_clearDistanceIndex:function(){return this._totalDistance=0,this._index=null,this},_distanceToPoints:function(a,b){var c=null;if(b>=this._totalDistance)c=[a[a.length-1],a[a.length-1]];else for(var d=0,e=this._index.length;d<e-1;++d)if(b>=this._index[d]&&b<this._index[d+1]){c=[a[d],a[d+1]];break}return c},_getInterpolator:function(b){return new a.LinearFunction([b[0].lng,b[0].lat],[b[1].lng,b[1].lat])},animateLine:function(b){var c=function(b){return function(c,d,e){var f=b.indexOf(d[0]);c.setLatLngs(b.slice(0,f+1).concat(new a.LatLng(e.y,e.x)))}};a.AnimationUtils.animateLine(this,a.extend({},{update:c(this._latlngs.slice())},b))}};a.extend(a.Polyline.prototype,e),a.Polyline.prototype.getTextAnchor=function(){var a=this.getCenter();return this._map.latLngToLayerPoint(a)},a.extend(a.SVG.prototype,c,d),a.Point.prototype.rotate=function(b,c){var d=this.distanceTo(c),e=b*a.LatLng.DEG_TO_RAD+Math.atan2(this.y-c.y,this.x-c.x);this.x=c.x+d*Math.cos(e),this.y=c.y+d*Math.sin(e)},a.extend(a.GeoJSON,{asFeature:function(a){return"Feature"===a.type||"FeatureCollection"===a.type?a:{type:"Feature",properties:{},geometry:a}}});var f=a.extend({},c);f.getCenter=function(){var b,c,d,e,f,g,h=this._latlngs,i=h.length;for(b=0,c=i-1,area=0,lat=0,lng=0;b<i;c=b++)d=h[b],e=h[c],f=d.lat*e.lng-e.lat*d.lng,lat+=(d.lat+e.lat)*f,lng+=(d.lng+e.lng)*f,area+=f/2;return g=area?new a.LatLng(lat/(6*area),lng/(6*area)):h[0],g.area=area,g},a.extend(a.LatLng,{DEG_TO_RAD:Math.PI/180,RAD_TO_DEG:180/Math.PI,MAX_MARGIN:1e-9}),a.Point.prototype.rotate=function(b,c){var d=this.distanceTo(c),e=b*a.LatLng.DEG_TO_RAD+Math.atan2(this.y-c.y,this.x-c.x);this.x=c.x+d*Math.cos(e),this.y=c.y+d*Math.sin(e)},a.RegularPolygonMarker=a.Path.extend({initialize:function(b,c){a.setOptions(this,c),this._latlng=b,this.options.numberOfSides=Math.max(this.options.numberOfSides,3)},options:{fill:!0,radiusX:10,radiusY:10,rotation:0,numberOfSides:3,position:{x:0,y:0},maxDegrees:360,gradient:!0,dropShadow:!1,interactive:!0},setLatLng:function(a){return this._latlng=a,this.redraw()},projectLatLngs:function(){this._point=this._map.latLngToLayerPoint(this._latlng),this._points=this._getPoints(this._point,!1,this.options),(this.options.innerRadius||this.options.innerRadiusX&&this.options.innerRadiusY)&&(this._innerPoints=this._getPoints(this._point,!0,this.options).reverse())},_project:function(){this.projectLatLngs(),this._updateBounds()},_updateBounds:function(){var b=this._map,c=this.options.radius||this.options.radiusX,d=this.options.radius||this.options.radiusY,e=c*Math.cos(Math.PI/4),f=d*Math.sin(Math.PI/4),g=b.project(this._latlng),h=new a.Point(g.x-e,g.y+f),i=new a.Point(g.x+e,g.y-f);this._pxBounds=new a.Bounds(h,i)},_update:function(){this._map&&this._renderer._setPath(this,this.getPathString())},getBounds:function(){var b=this._map,c=this.options.radius||this.options.radiusX,d=this.options.radius||this.options.radiusY,e=c*Math.cos(Math.PI/4),f=d*Math.sin(Math.PI/4),g=b.project(this._latlng),h=new a.Point(g.x-e,g.y+f),i=new a.Point(g.x+e,g.y-f),j=b.unproject(h),k=b.unproject(i);return new a.LatLngBounds(j,k)},setRadius:function(a){return this.options.radius=a,this.redraw()},setRadiusXY:function(a,b){return this.options.radius=null,this.options.radiusX=a,this.options.radiusY=b,this.redraw()},setInnerRadius:function(a){return this.options.innerRadius=a,this.redraw()},setInnerRadiusXY:function(a,b){return this.options.innerRadius=null,this.options.innerRadiusX=a,this.options.innerRadiusY=b,this.redraw()},setRotation:function(a){return this.options.rotation=a,this.redraw()},setNumberOfSides:function(a){return this.options.numberOfSides=a,this.redraw()},getLatLng:function(){return this._latlng},getPathString:function(){var b=this.getTextAnchor();if(this._shape)if("circle"===this._shape.tagName||"ellipse"===this._shape.tagName)this._shape.setAttribute("cx",b.x),this._shape.setAttribute("cy",b.y);else{var c=this._shape.getAttribute("width"),d=this._shape.getAttribute("height");this._shape.setAttribute("x",b.x-Number(c)/2),this._shape.setAttribute("y",b.y-Number(d)/2)}return this._path&&this._path.setAttribute("shape-rendering","geometricPrecision"),new a.SVGPathBuilder(this._points,this._innerPoints).build(6)},getTextAnchor:function(){return this._point},_getPoints:function(b,c,d){for(var e,f,g=d.maxDegrees||360,h=g/Math.max(d.numberOfSides,3),i=g,j=0,k=[],l=c?d.innerRadius||d.innerRadiusX:d.radius||d.radiusX,m=c?d.innerRadius||d.innerRadiusY:d.radius||d.radiusY,n=function(b){return b*a.LatLng.DEG_TO_RAD};j<i;)f=n(j),e=this._getPoint(b,f,l,m,d),k.push(e),j+=h;return k},_getPoint:function(b,c,d,e,f){var g=f.position?b.add(new a.Point(f.position.x,f.position.y)):b,h=new a.Point(g.x+d*Math.cos(c),g.y+e*Math.sin(c));return h.rotate(f.rotation,g),h},_getDefaultDiameter:function(a){var b=Math.PI/this.options.numberOfSides,c=a*Math.cos(b);return 1.75*c},_applyCustomStyles:function(){(this.options.shapeImage||this.options.imageCircleUrl)&&this._renderer._createShapeImage(this)},toGeoJSON:function(){var b=a.Marker.prototype.toGeoJSON.call(this);return b.properties=this.options,b}}),a.StarMarker=a.RegularPolygonMarker.extend({options:{numberOfPoints:5,rotation:-15,maxDegrees:360,gradient:!0,dropShadow:!0},setNumberOfPoints:function(a){return this.options.numberOfPoints=a,this.redraw()},_getPoints:function(b,c,d){for(var e,f,g,h=d.maxDegrees||360,i=h/d.numberOfPoints,j=h,k=0,l=[],m=c?d.innerRadius||d.innerRadiusX:d.radius||d.radiusX,n=c?d.innerRadius||d.innerRadiusY:d.radius||d.radiusY,o=function(b){return b*a.LatLng.DEG_TO_RAD};k<j;)g=o(k),e=this._getPoint(b,g,m,n,d),f=this._getPoint(b,g+o(i)/2,m/2,n/2,d),l.push(e),l.push(f),k+=i;return l}}),a.starMarker=function(b,c){return new a.StarMarker(b,c)},a.TriangleMarker=a.RegularPolygonMarker.extend({options:{numberOfSides:3,rotation:30,radius:5}}),a.triangleMarker=function(b,c){return new a.TriangleMarker(b,c)},a.DiamondMarker=a.RegularPolygonMarker.extend({options:{numberOfSides:4,radiusX:5,radiusY:10}}),a.diamondMarker=function(b,c){return new a.DiamondMarker(b,c)},a.SquareMarker=a.RegularPolygonMarker.extend({options:{numberOfSides:4,rotation:45,radius:5}}),a.squareMarker=function(b,c){return new a.SquareMarker(b,c)},a.PentagonMarker=a.RegularPolygonMarker.extend({options:{numberOfSides:5,rotation:-18,radius:5}}),a.pentagonMarker=function(b,c){return new a.PentagonMarker(b,c)},a.HexagonMarker=a.RegularPolygonMarker.extend({options:{numberOfSides:6,rotation:30,radius:5}}),a.hexagonMarker=function(b,c){return new a.HexagonMarker(b,c)},a.OctagonMarker=a.RegularPolygonMarker.extend({options:{numberOfSides:8,rotation:22.5,radius:5}}),a.octagonMarker=function(b,c){return new a.OctagonMarker(b,c)},a.MapMarker=a.Path.extend({initialize:function(b,c){a.setOptions(this,c),this._latlng=b},options:{fill:!0,fillOpacity:1,opacity:1,radius:15,innerRadius:5,position:{x:0,y:0},rotation:0,numberOfSides:50,color:"#000000",fillColor:"#0000FF",weight:1,gradient:!0,dropShadow:!0,interactive:!0},setLatLng:function(a){return this._latlng=a,this.redraw()},projectLatLngs:function(){this._point=this._map.latLngToLayerPoint(this._latlng),this._points=this._getPoints(this._point,!1,this.options),this.options.innerRadius>0&&(this._innerPoints=this._getPoints(this._point,!0,this.options).reverse())},_project:function(){this.projectLatLngs(),this._updateBounds()},_updateBounds:function(){var b=this._map,c=3*this.options.radius,d=b.project(this._latlng),e=new a.Point(d.x-this.options.radius,d.y),f=new a.Point(d.x+this.options.radius,d.y-c);this._pxBounds=new a.Bounds(e,f)},_update:function(){this._map&&this._renderer._setPath(this,this.getPathString())},getBounds:function(){var b=this._map,c=3*this.options.radius,d=b.project(this._latlng),e=new a.Point(d.x-this.options.radius,d.y),f=new a.Point(d.x+this.options.radius,d.y-c),g=b.unproject(e),h=b.unproject(f);return new a.LatLngBounds(g,h)},getLatLng:function(){return this._latlng},setRadius:function(a){return this.options.radius=a,this.redraw()},setInnerRadius:function(a){return this.options.innerRadius=a,this.redraw()},setRotation:function(a){return this.options.rotation=a,this.redraw()},setNumberOfSides:function(a){return this.options.numberOfSides=a,this.redraw()},getPathString:function(){var b=this.getTextAnchor();if(this._shape)if("circle"===this._shape.tagName||"ellipse"===this._shape.tagName)this._shape.setAttribute("cx",b.x),this._shape.setAttribute("cy",b.y);else{var c=this._shape.getAttribute("width"),d=this._shape.getAttribute("height");this._shape.setAttribute("x",b.x-Number(c)/2),this._shape.setAttribute("y",b.y-Number(d)/2)}return this._path&&this._path.setAttribute("shape-rendering","geometricPrecision"),new a.SVGPathBuilder(this._points,this._innerPoints).build(6)},getTextAnchor:function(){var b=this.options.position?this._point.add(new a.Point(this.options.position.x,this.options.position.y)):this._point;return new a.Point(b.x,b.y-2*this.options.radius)},_getPoints:function(b,c,d){var e,f,g=c?360:210,h=c?g/Math.max(d.numberOfSides,3):g/50,i=c?g+d.rotation:g,j=c?d.rotation:-30,k=[],l=d.radius,m=Math.sqrt(.75),n=function(b){return b*a.LatLng.DEG_TO_RAD},o=d.position?b.add(new a.Point(d.position.x,d.position.y)):b;for(c||(k.push(o),k.push(new a.Point(o.x+m*l,o.y-1.5*l)));j<i;)f=n(j),e=this._getPoint(o,f,l,c,d),k.push(e),j+=h;return c||k.push(new a.Point(o.x-m*l,o.y-1.5*l)),k},_getPoint:function(b,c,d,e,f){var g=d;return d=e?f.innerRadius:d,new a.Point(b.x+d*Math.cos(c),b.y-2*g-d*Math.sin(c))},_applyCustomStyles:function(){(this.options.shapeImage||this.options.imageCircleUrl)&&this._renderer._createShapeImage(this)}}),a.mapMarker=function(){return new a.MapMarker(latlng,options)},a.SVGMarker=a.Path.extend({initialize:function(b,c){a.setOptions(this,c),this._svg=c.svg||'<svg xmlns="http://www.w3.org/2000/svg" width="1" height="1"/>',0===this._svg.indexOf("<")&&(this._data=(new DOMParser).parseFromString(this._svg,"text/xml")),this._latlng=b},projectLatLngs:function(){this._point=this._map.latLngToLayerPoint(this._latlng)},_project:function(){this.projectLatLngs(),this._updateBounds()},_updateBounds:function(){var b=this._map,c=200,d=200,e=c*Math.cos(Math.PI/4),f=d*Math.sin(Math.PI/4),g=b.project(this._latlng),h=new a.Point(g.x-e,g.y+f),i=new a.Point(g.x+e,g.y-f);this._pxBounds=new a.Bounds(h,i)},_update:function(){this._map&&this._path&&this.updateSVG()},setLatLng:function(a){this._latlng=a,this.redraw()},getLatLng:function(){return this._latlng},onAdd:function(){var a=this;if(this._renderer=this._map.getRenderer(this),this._data)a._reset(),a.addSVG(),a.updateSVG();else{var b=new XMLHttpRequest;b.onreadystatechange=function(){4===this.readyState&&200===this.status&&(a._data=this.responseXML,a._reset(),a.addSVG(),a.updateSVG())},b.open("GET",this._svg,!0),b.send(null)}},addSVG:function(){var b=this,c=b._data;if(b._svgEl="svg"===c.nodeName.toLowerCase()?c.cloneNode(!0):c.querySelector("svg").cloneNode(!0),!b._g){var d=a.SVG.create("g");if(b._g=d,b._g.id=a.stamp(b._g),b._svgEl.id=a.stamp(b._svgEl),b._g.appendChild(b._svgEl),b._path=b._g,b._renderer._rootGroup.appendChild(b._path),b.addInteractiveTarget(b._path),b.options.interactive){a.DomUtil.addClass(b._g,"leaflet-interactive");var e=function(b){var c=b.childNodes;if(b.id&&(b.id=a.stamp(b)),c)for(var d=0,f=c.length;d<f;++d)e(c[d])};e(b._svgEl)}}},updateSVG:function(){var b=this,c=b.options||{};b._g.setAttribute("pointer-events",c.pointerEvents||(c.interactive?"visiblePainted":"none")),c.setStyle&&c.setStyle.call(b,b._svgEl);var d=b._svgEl.getAttribute("width"),e=b._svgEl.getAttribute("height"),f=d?d.replace("px",""):"100%",g=e?e.replace("px",""):"100%";"100%"===f&&(f=c.size.x,g=c.size.y,b._svgEl.setAttribute("width",f+(String(f).indexOf("%")!==-1?"":"px")),b._svgEl.setAttribute("height",g+(String(g).indexOf("%")!==-1?"":"px")));var h=c.size||new a.Point(f,g),i=new a.Point(h.x/f,h.y/g),j=[],k=c.anchor||new a.Point(-h.x/2,-h.y/2),l=b._point.x+k.x,m=b._point.y+k.y;j.push("translate("+l+" "+m+")"),j.push("scale("+i.x+" "+i.y+")"),b.options.rotation&&j.push("rotate("+c.rotation+" "+f/2+" "+g/2+")"),b._g.setAttribute("transform",j.join(" "))},getElement:function(){return me._g},redraw:function(){return this._map&&this._path&&this._renderer._updatePath(this),this},toGeoJSON:function(){return a.Util.pointToGeoJSON.call(this)}}),a.svgMarker=function(b,c){return new a.SVGMarker(b,c)},a.MarkerGroup=a.FeatureGroup.extend({initialize:function(b,c){a.FeatureGroup.prototype.initialize.call(this,c),this.setLatLng(b)},setStyle:function(a){return this},setLatLng:function(a){return this._latlng=a,this.eachLayer(function(b){b.setLatLng&&b.setLatLng(a)}),this},getLatLng:function(a){return this._latlng},toGeoJSON:function(){var b={type:"FeatureCollection",features:[]},c=function(b){return function(c){b.features.push(a.Util.pointToGeoJSON.call(c))}};return this.eachLayer(c(b)),b}}),a.markerGroup=function(b,c){return new a.MarkerGroup(b,c)}},window),function(a,b){"function"==typeof define&&define.amd?define(["leaflet"],a):"object"==typeof exports&&(module.exports=a(require("leaflet"))),"undefined"!=typeof b&&b.L&&(b.L.YourPlugin=a(L))}(function(a){a.BarMarker=a.Path.extend({initialize:function(b,c){a.setOptions(this,c),this._latlng=b},options:{fill:!0,width:2,maxHeight:10,position:{x:0,y:0},weight:1,color:"#000",opacity:1,gradient:!0,dropShadow:!1,lineCap:"square",lineJoin:"miter"},setLatLng:function(a){return this._latlng=a,this.redraw()},_project:function(){this._point=this._map.latLngToLayerPoint(this._latlng),this._points=this._getPoints()},_update:function(){this._map&&this._map&&this._renderer._setPath(this,this.getPathString())},getBounds:function(){var b=this._map,c=b.project(this._latlng),d=this.options.width/2,e=new a.Point(c.x-d,c.y),f=new a.Point(c.x+d,c.y-this.options.maxHeight),g=b.unproject(e),h=b.unproject(f);return new a.LatLngBounds(g,h)},getLatLng:function(){return this._latlng},getPathString:function(){return this._path.setAttribute("shape-rendering","crispEdges"),new a.SVGPathBuilder(this._points).build()},_getPoints:function(){var b,c,d,e,f=[],g=this._point.x+this.options.position.x,h=this._point.y+this.options.position.y,i=this.options.width/2,j=this.options.value/this.options.maxValue*this.options.maxHeight;return b=new a.Point(g+i,h),c=new a.Point(g+i,h-j),d=new a.Point(g-i,h-j),e=new a.Point(g-i,h),f=[b,c,d,e]}}),a.barMarker=function(b,c){return new a.BarMarker(b,c)},a.ChartMarker=a.FeatureGroup.extend({initialize:function(b,c){a.Util.setOptions(this,c),this._layers={},this._latlng=b,this._loadComponents()},setLatLng:function(a){return this._latlng=a,this.redraw()},getLatLng:function(){return this._latlng},_loadComponents:function(){},_highlight:function(a){return a.weight&&(a.weight*=2),a},_unhighlight:function(a){return a.weight&&(a.weight/=2),a},_bindMouseEvents:function(b){var c=this,d=this.options.tooltipOptions;b.on("mouseover",function(b){var e,f=this.options,g=f.key,h=f.value,i=b.layerPoint,j=i.x-this._point.x,k=i.y-this._point.y,l=f.iconSize,m=j,n=k,o=5;l&&(m=j<0?l.x-j+o:-j-o,n=k<0?l.y-k+o:-k-o,e=new a.Point(m,n));var p={},q=f.displayText?f.displayText(h):h;p[g]={name:f.displayName,value:q};var r=new a.LegendIcon(p,f,{className:"leaflet-div-icon",iconSize:d?d.iconSize:l,iconAnchor:e||new a.Point((-5),0)});f.marker=new a.Marker(c._latlng,{icon:r}),f=c._highlight(f),this.initialize(c._latlng,f),this.redraw(),this.setStyle(f),c.addLayer(f.marker)}),b.on("mouseout",function(a){var b=this.options;b=c._unhighlight(b),this.initialize(c._latlng,b),this.redraw(),this.setStyle(b),c.removeLayer(b.marker)})},bindPopup:function(a,b){this.eachLayer(function(c){c.bindPopup(a,b)})},openPopup:function(a){for(var b in this._layers){var c=this._layers[b];a=a||this._latlng,c.openPopup(a);break}},closePopup:function(){for(var a in this._layers){var b=this._layers[a];latlng=latlng||this._latlng,b.closePopup();break}},redraw:function(){this.clearLayers(),this._loadComponents()},toGeoJSON:function(){return a.Util.pointToGeoJSON.call(this)}}),a.BarChartMarker=a.ChartMarker.extend({initialize:function(b,c){a.setOptions(this,c),a.ChartMarker.prototype.initialize.call(this,b,c)},options:{weight:1,opacity:1,color:"#000",fill:!0,position:{x:0,y:0},width:10,offset:0,iconSize:new a.Point(50,40)},_loadComponents:function(){var b,c,d,e,f,g,h,i=this.options,j=Object.keys(this.options.data),k=j.length,l=this.options.width,m=this.options.offset||0,n=this.options.data,o=this.options.chartOptions;f=-(l*k+m*(k-1))/2+l/2,g=0;for(var p in n)b=n[p],h=o[p],c=h.minValue||0,d=h.maxValue||100,i.fillColor=h.fillColor||this.options.fillColor,i.value=b,i.minValue=c,i.maxValue=d,i.position={x:f,y:g},i.width=l,i.maxHeight=h.maxHeight||10,i.key=p,i.value=b,i.displayName=h.displayName,i.opacity=this.options.opacity||1,i.fillOpacity=this.options.fillOpacity||.7,i.weight=this.options.weight||1,i.color=h.color||this.options.color,i.displayText=h.displayText,e=new a.BarMarker(this._latlng,i),this._bindMouseEvents(e),this.addLayer(e),f+=l+m}}),a.RadialBarMarker=a.Path.extend({initialize:function(b,c){a.setOptions(this,c),this._latlng=b},options:{fill:!0,radius:10,rotation:0,numberOfSides:30,position:{x:0,y:0},gradient:!0,dropShadow:!1},setLatLng:function(a){return this._latlng=a,this.redraw()},_project:function(){this._point=this._map.latLngToLayerPoint(this._latlng),this._points=this._getPoints()},_update:function(){this._map&&this._map&&this._renderer._setPath(this,this.getPathString())},getBounds:function(){var b=this._map,c=this.options.radiusX||this.options.radius,d=this.options.radiusY||this.options.radius,e=c*Math.cos(Math.PI/4),f=d*Math.sin(Math.PI/4),g=b.project(this._latlng),h=new a.Point(g.x-e,g.y+f),i=new a.Point(g.x+e,g.y-f),j=b.unproject(h),k=b.unproject(i);return new a.LatLngBounds(j,k)},getLatLng:function(){return this._latlng},getPathString:function(){var b=this.options.endAngle-this.options.startAngle,c=b>=180?"1":"0",d=this.options.radiusX||this.options.radius,e=this.options.radiusY||this.options.radius,f="M"+this._points[0].x.toFixed(2)+","+this._points[0].y.toFixed(2)+"A"+d.toFixed(2)+","+e.toFixed(2)+" 0 "+c+",1 "+this._points[1].x.toFixed(2)+","+this._points[1].y.toFixed(2)+"L";return this._innerPoints?(f=f+this._innerPoints[0].x.toFixed(2)+","+this._innerPoints[0].y.toFixed(2),f=f+"A"+(d-this.options.barThickness).toFixed(2)+","+(e-this.options.barThickness).toFixed(2)+" 0 "+c+",0 "+this._innerPoints[1].x.toFixed(2)+","+this._innerPoints[1].y.toFixed(2)+"z"):f=f+this._point.x.toFixed(2)+","+this._point.y.toFixed(2)+"z",a.Browser.vml&&(f=Core.SVG.path(f)),this._path.setAttribute("shape-rendering","geometricPrecision"),f},_getPoints:function(){var b=this.options.endAngle-this.options.startAngle,c=this.options.endAngle+this.options.rotation,d=this.options.startAngle+this.options.rotation,e=[],f="radiusX"in this.options?this.options.radiusX:this.options.radius,g="radiusY"in this.options?this.options.radiusY:this.options.radius,h=function(b){return b*a.LatLng.DEG_TO_RAD};c=c||0,360===b&&(c-=.1);var i=h(d),j=h(c);return e.push(this._getPoint(i,f,g)),e.push(this._getPoint(j,f,g)),this.options.barThickness&&(this._innerPoints=[],this._innerPoints.push(this._getPoint(j,f-this.options.barThickness,g-this.options.barThickness)),this._innerPoints.push(this._getPoint(i,f-this.options.barThickness,g-this.options.barThickness))),e},_getPoint:function(b,c,d){return new a.Point(this._point.x+this.options.position.x+c*Math.cos(b),this._point.y+this.options.position.y+d*Math.sin(b))}}),a.radialBarMarker=function(b,c){return new a.RadialBarMarker(b,c)},a.PieChartMarker=a.ChartMarker.extend({initialize:function(b,c){a.Util.setOptions(this,c),a.ChartMarker.prototype.initialize.call(this,b,c)},options:{weight:1,opacity:1,color:"#000",fill:!0,radius:10,rotation:0,numberOfSides:50,mouseOverExaggeration:1.2,maxDegrees:360,iconSize:new a.Point(50,40)},_highlight:function(a){var b=a.radiusX,c=a.radiusY,d=a.barThickness;return a.oldBarThickness=d,a.oldRadiusX=b,a.oldRadiusY=c,a.radiusX*=a.mouseOverExaggeration,a.radiusY*=a.mouseOverExaggeration,a.barThickness=a.radiusX-b+d,a},_unhighlight:function(a){return a.radiusX=a.oldRadiusX,a.radiusY=a.oldRadiusY,a.barThickness=a.oldBarThickness,a},_loadComponents:function(){var b,c,d,e,f=0,g=0,h=0,i=this.options.maxDegrees||360,j=this.options.rotation,k=this.options,l=this.options.data,m=this.options.chartOptions,n=function(a,b){var c=0;return a[b]&&(c=parseFloat(a[b])),c};for(e in l)b=n(l,e),f+=b;if(f>0)for(e in l)b=parseFloat(l[e])||0,d=m[e],h=b/f,g=h*i,k.startAngle=j,k.endAngle=j+g,k.fillColor=d.fillColor,k.color=d.color||"#000",k.radiusX=this.options.radiusX||this.options.radius,k.radiusY=this.options.radiusY||this.options.radius,k.rotation=0,k.key=e,k.value=b,k.displayName=d.displayName,k.displayText=d.displayText,c=new a.RadialBarMarker(this._latlng,k),this._bindMouseEvents(c),j=k.endAngle,this.addLayer(c)}}),a.pieChartMarker=function(b,c){return new a.PieChartMarker(b,c)},a.CoxcombChartMarker=a.PieChartMarker.extend({statics:{SIZE_MODE_RADIUS:"radius",SIZE_MODE_AREA:"area"}}),a.CoxcombChartMarker=a.CoxcombChartMarker.extend({initialize:function(b,c){a.Util.setOptions(this,c),a.PieChartMarker.prototype.initialize.call(this,b,c)},options:{weight:1,opacity:1,color:"#000",fill:!0,radius:10,rotation:0,numberOfSides:50,mouseOverExaggeration:1.2,maxDegrees:360,iconSize:new a.Point(50,40),sizeMode:a.CoxcombChartMarker.SIZE_MODE_AREA},_loadComponents:function(){var b,c,d,e,f,g=0,h=this.options.maxDegrees||360,i=this.options.rotation,j=this.options,k="radiusX"in this.options?this.options.radiusX:this.options.radius,l="radiusY"in this.options?this.options.radiusY:this.options.radius,m=Object.keys(this.options.data),n=m.length,o=this.options.data,p=this.options.chartOptions;g=h/n;var q=function(a){return Math.sqrt(n*a/Math.PI)};for(var r in o){if(b=parseFloat(o[r])||0,f=p[r],c=f.minValue||0,d=f.maxValue,this.options.sizeMode===a.CoxcombChartMarker.SIZE_MODE_RADIUS){var s=new a.LinearFunction(new a.Point(c,0),new a.Point(d,k)),t=new a.LinearFunction(new a.Point(c,0),new a.Point(d,l));j.radiusX=s.evaluate(b),j.radiusY=t.evaluate(b)}else{var u=Math.max(k,l),v=Math.PI*Math.pow(u,2)/n,w=new a.LinearFunction(new a.Point(c,0),new a.Point(d,v),{postProcess:q});j.radiusX=w.evaluate(b),j.radiusY=j.radiusX}j.startAngle=i,j.endAngle=i+g,j.fillColor=f.fillColor,j.color=f.color||"#000",j.rotation=0,j.key=r,j.value=b,j.displayName=f.displayName,j.displayText=f.displayText,e=new a.RadialBarMarker(this._latlng,j),this._bindMouseEvents(e),i=j.endAngle,this.addLayer(e)}}}),a.coxcombChartMarker=function(b,c){return new a.CoxcombChartMarker(b,c)},a.RadialBarChartMarker=a.ChartMarker.extend({initialize:function(b,c){a.Util.setOptions(this,c),a.ChartMarker.prototype.initialize.call(this,b,c)},options:{weight:1,opacity:1,color:"#000",fill:!0,radius:10,rotation:0,numberOfSides:30,offset:2,barThickness:5,maxDegrees:360,iconSize:new a.Point(50,40)},_loadComponents:function(){var b,c,d,e,f,g=this.options.rotation,h=this.options.maxDegrees||360,i=this.options,j=this.options.radiusX||this.options.radius,k=this.options.radiusY||this.options.radius,l=this.options.data,m=this.options.chartOptions,n=this.options.barThickness||4,o=this.options.offset||2;for(var p in l){b=parseFloat(l[p]),f=m[p],c=f.minValue||0,d=f.maxValue||100;var q=new a.LinearFunction(new a.Point(c,0),new a.Point(d,h));g=q.evaluate(b),i.startAngle=this.options.rotation,i.endAngle=this.options.rotation+g,i.fillColor=f.fillColor,i.radiusX=j,i.radiusY=k,i.barThickness=n,i.rotation=0,i.key=p,i.value=b,i.displayName=f.displayName,i.displayText=f.displayText,i.weight=this.options.weight||1,e=new a.RadialBarMarker(this._latlng,i),this._bindMouseEvents(e),this.addLayer(e),j+=n+o,k+=n+o}}}),a.radialBarChartMarker=function(b,c){return new a.RadialBarChartMarker(b,c)},a.StackedRegularPolygonMarker=a.ChartMarker.extend({options:{iconSize:new a.Point(50,40)},initialize:function(b,c){a.Util.setOptions(this,c),a.ChartMarker.prototype.initialize.call(this,b,c)},_loadComponents:function(){var b,c,d,e,f=0,g=0,h=this.options,i=this.options.data,j=this.options.chartOptions,k=[];for(e in i){b=parseFloat(i[e]),d=j[e],minValue=d.minValue||0,maxValue=d.maxValue||100,minRadius=d.minRadius||0,maxRadius=d.maxRadius||10,h.fillColor=d.fillColor||this.options.fillColor,h.value=b,h.minValue=minValue,h.maxValue=maxValue;var l=new a.LinearFunction(new a.Point(minValue,minRadius),new a.Point(maxValue,maxRadius)),m=l.evaluate(b);h.radiusX=f+m,h.radiusY=g+m,h.innerRadiusX=f,h.innerRadiusY=g,h.key=e,h.displayName=d.displayName,h.opacity=this.options.opacity||1,h.fillOpacity=this.options.fillOpacity||.7,h.weight=this.options.weight||1,h.color=d.color||this.options.color,h.displayText=d.displayText,c=new a.RegularPolygonMarker(this._latlng,h),this._bindMouseEvents(c),f=h.radiusX,g=h.radiusY,this.options.drawReverse?k.push(c):this.addLayer(c)}if(this.options.drawReverse)for(var n=k.pop();n;)this.addLayer(n),n=k.pop()}}),a.RadialMeterMarker=a.ChartMarker.extend({initialize:function(b,c){a.Util.setOptions(this,c),a.ChartMarker.prototype.initialize.call(this,b,c)},options:{weight:1,opacity:1,color:"#000",fill:!0,radius:10,rotation:180,numberOfSides:30,offset:2,barThickness:5,maxDegrees:180,iconSize:new a.Point(50,40),backgroundStyle:{fill:!0,fillColor:"#707070",fillOpacity:.2,opacity:.8,color:"#505050"}},_loadComponents:function(){var b,c,d,e,f,g,h=this.options.rotation,i=this.options.maxDegrees||360,j=this.options,k=this.options.radiusX||this.options.radius,l=this.options.radiusY||this.options.radius,m=this.options.data,n=this.options.chartOptions,o=this.options.barThickness||4,p=h,q=this.options.numSegments||10,r=i/q;for(var s in m){b=parseFloat(m[s]),f=n[s],g=this.options.displayOptions?this.options.displayOptions[s]:{},c=f.minValue||0,d=f.maxValue||100;for(var t,u,v=d-c,w=i/v*(b-c),x=h+w,y=h+i,z=new a.LinearFunction(new a.Point(h,c),new a.Point(y,d));p<x;){j.startAngle=p,t=Math.min(r,x-p),j.endAngle=p+t,j.fillColor=f.fillColor,j.radiusX=k,j.radiusY=l,j.barThickness=o,j.rotation=0,j.key=s,j.value=b,j.displayName=f.displayName,j.displayText=f.displayText,u=z.evaluate(p+t);for(var A in g)j[A]=g[A].evaluate?g[A].evaluate(u):g[A];e=new a.RadialBarMarker(this._latlng,j),this._bindMouseEvents(e),this.addLayer(e),p+=t}if(this.options.backgroundStyle&&p<y){t=y-p,j.endAngle=p+t,j.radiusX=k,j.radiusY=l,j.barThickness=o,j.rotation=0,j.key=s,j.value=b,j.displayName=f.displayName,j.displayText=f.displayText,j.fillColor=null,
j.fill=!1,j.gradient=!1;for(var B in this.options.backgroundStyle)j[B]=this.options.backgroundStyle[B];u=z.evaluate(p+t),e=new a.RadialBarMarker(this._latlng,j),this.addLayer(e)}}}})},window),function(a,b){"function"==typeof define&&define.amd?define(["leaflet"],a):"object"==typeof exports&&(module.exports=a(require("leaflet"))),"undefined"!=typeof b&&b.L&&(b.L.YourPlugin=a(L))}(function(a){a.LocationModes={LATLNG:function(b,c){var d=function(c,d){var e=a.Util.getFieldValue(b,c),f=a.Util.getFieldValue(b,d),g=null;if(e&&f){var h=new a.LatLng(e,f);g={location:h,text:[h.lat.toFixed(3),h.lng.toFixed(3)].join(", "),center:h}}return g},e=d(this.options.latitudeField,this.options.longitudeField);if(!e&&this.options.fallbackLocationFields)for(var f,g=0;!e&&g<this.options.fallbackLocationFields.length;)f=this.options.fallbackLocationFields[g],e=d(f.latitudeField,f.longitudeField),g++;return e},GEOHASH:function(b,c){var d,e=this.options.geohashField?a.Util.getFieldValue(b,this.options.geohashField):c,f=decodeGeoHash(e);return f.latitude[2]&&f.longitude[2]&&(d=new a.LatLngBounds(new a.LatLng(f.latitude[0],f.longitude[0]),new a.LatLng(f.latitude[1],f.longitude[1]))),{location:d,text:e,center:d.getCenter()}},GWCOUNTRY:function(b,c){var d,e,f=this.options.codeField?a.Util.getFieldValue(b,this.options.codeField):c,g=a.gwNoLookup||{},h=a.countries||{},i=a.countryCentroids||{},j=f.toUpperCase();f=j;var k=j in g;k&&(f=g[j]||f),f?(d=h[f],e=i[f]):console.log("Code not found: "+j);var l=new a.GeoJSON(d);return{location:l,text:a.GeometryUtils.getName(d)||f,center:e}},COUNTRY:function(b,c){var d,e,f=this.options.codeField?a.Util.getFieldValue(b,this.options.codeField):c,g=a.codeLookup||{},h=a.alpha2Lookup||{},i=a.fips2Lookup||{},j=a.countries||{},k=a.countryCentroids||{},l=f.toUpperCase();f=l,2===f.length?f=h[l]||i[l]:3===f.length&&(f=g[l]||f),f?(d=j[f],e=k[f]):console.log("Code not found: "+l);var m=new a.GeoJSON(d);return{location:m,text:a.GeometryUtils.getName(d)||f,center:e}},STATE:function(b,c){var d,e,f=this.options.codeField?a.Util.getFieldValue(b,this.options.codeField):c,g=a.states||{},h=a.stateCentroids||{},i=f.toUpperCase();f=i,d=g[f],e=h[f];var j=new a.GeoJSON(d);return{location:j,text:a.GeometryUtils.getName(d)||f,center:e}},GEOJSON:function(b,c){var d=this.options.geoJSONField,e=d?a.Util.getFieldValue(b,d):b,f=null;if(e){var g=this,h=function(a,b){return g.recordToLayer(a,b)};f=a.GeometryUtils.getGeoJSONLocation(e,b,this.options.locationTextField,h)}return f},LOOKUP:function(b,c){var d=this.options.codeField?this.options.codeField.call?this.options.codeField.call(this,b):a.Util.getFieldValue(b,this.options.codeField):c;this._lookupIndex=this.options.locationLookupIndexed?this.options.locationLookup:this._lookupIndex||a.GeometryUtils.indexFeatureCollection(this.options.locationLookup,this.options.locationIndexField||this.options.codeField);var e=this._lookupIndex[d],f=null;if(e||0!==d.indexOf("0")||(e=this._lookupIndex[d.substring(1)]),e){var g=this,h=function(a,b){return g.recordToLayer(a,b)};f=a.GeometryUtils.getGeoJSONLocation(e,b,this.options.locationTextField,h)}return f},CUSTOM:function(b,c){var d,e=this.options.codeField,f=e&&"function"==typeof e?e.call(this,b):a.Util.getFieldValue(b,e),g={};if(g[f]=b,this.options.getLocation){var h=this,i=function(a,b){h.locationToLayer(b,g[a])};d=this.options.getLocation(g,e,[f],i)}return d}},a.DataLayer=a.LayerGroup.extend({includes:a.Mixin.Events,options:{recordsField:"features",locationMode:a.LocationModes.LATLNG,latitudeField:"geometry.coordinates.1",longitudeField:"geometry.coordinates.0",displayField:null,displayOptions:null,layerOptions:{numberOfSides:4,radius:10,weight:1,color:"#000"},showLegendTooltips:!0,tooltipOptions:{iconSize:new a.Point(60,50),iconAnchor:new a.Point((-5),50),mouseOverExaggeration:2},setHighlight:function(a){return a.weight=a.weight||1,a.fillOpacity=a.fillOpacity||.5,a.weight*=2,a.fillOpacity/=1.5,a},unsetHighlight:function(a){return a.weight=a.weight||1,a.fillOpacity=a.fillOpacity||.25,a.weight/=2,a.fillOpacity*=1.5,a}},initialize:function(b,c){a.setOptions(this,c),a.LayerGroup.prototype.initialize.call(this,c),b=b||{},this._includeFunction=this.options.filter||this.options.includeLayer,this._markerFunction=this.options.getMarker||this._getMarker,this._addChildLayers(),this.addData(b)},_addChildLayers:function(){this._boundaryLayer=new a.LayerGroup,this.addLayer(this._boundaryLayer),this._trackLayer=new a.LayerGroup,this.addLayer(this._trackLayer)},_zoomFunction:function(a){var b=this._map,c=this,d=b.getZoom();if(this.options.maxZoom&&d>this.options.maxZoom)this.hiddenLayers=[],this.eachLayer(function(a){c.hiddenLayers.push(a),b.removeLayer(a)});else if(this.hiddenLayers){for(;this.hiddenLayers.length>0;){var e=this.hiddenLayers.pop();b.addLayer(e),this.options.backgroundLayer&&e.bringToBack&&e.bringToBack()}this.hiddenLayers=null}},_addLayer:function(a,b){return function(){a.addLayer(b)}},_removeLayer:function(a,b){return function(){a.removeLayer(b)}},onAdd:function(a){var b=this;this._map=a;for(var c in b._layers)b._layers.hasOwnProperty(c)&&setTimeout(this._addLayer(a,b._layers[c]),0);a.on("zoomend",b._zoomFunction,b)},onRemove:function(a){var b=this;for(var c in b._layers)b._layers.hasOwnProperty(c)&&setTimeout(this._removeLayer(a,b._layers[c]),0);b.tooltip&&(b._map.removeLayer(b.tooltip),b.tooltip=null),a.off("zoomend",b._zoomFunction,b)},bringToBack:function(){this.invoke("bringToBack"),this._trackLayer&&this._trackLayer.invoke("bringToBack"),this._boundaryLayer&&this._boundaryLayer.invoke("bringToBack")},bringToFront:function(){this._boundaryLayer&&this._boundaryLayer.invoke("bringToFront"),this._trackLayer&&this._trackLayer.invoke("bringToFront"),this.invoke("bringToFront")},getBounds:function(){var a;return this.eachLayer(function(b){b.getBounds&&(a?a.extend(b.getBounds()):a=b.getBounds())}),a},_getLocation:function(a,b){return this.options.locationMode.call(this,a,b)},_processLocation:function(a){var b=a.center;return b},_styleBoundary:function(b,c,d){if(b.setStyle){var e;this.options.boundaryStyle instanceof Function&&(e=this.options.boundaryStyle.call(this,d,b)),e=e||this.options.boundaryStyle||a.extend({},c,{fillOpacity:.2,interactive:!1}),b.setStyle(e)}return b},_addBoundary:function(b,c,d){var e,f=b.location;return this.options.includeBoundary&&(f instanceof a.LatLngBounds&&(f=new a.Rectangle(f)),f=this._styleBoundary(f,c,d),this._boundaryLayer.addLayer(f),e=f),e},_getLayer:function(a,b,c){var d=this._addBoundary(a,b,c);a=this._processLocation(a);var e;return a&&(this._markerFunction=this.options.getMarker||this._getMarker,e=this._markerFunction.call(this,a,b,c),e.boundaryLayer=d),e},_getMarker:function(b,c,d){var e;return b&&(e=c.numberOfSides>=30&&!(c.innerRadius||c.innerRadiusX&&c.innerRadiusY)?new a.CircleMarker(b,c):new a.RegularPolygonMarker(b,c)),e},_preProcessRecords:function(a){return a},_shouldLoadRecord:function(a){return this._includeFunction=this.options.filter||this.options.includeLayer,!this._includeFunction||this._includeFunction.call(this,a)},_loadRecords:function(a){var b;a=this._preProcessRecords(a);for(var c in a)if(a.hasOwnProperty(c)){var d=a[c];d=this.options.deriveProperties?this.options.deriveProperties(d):d;var e=this._shouldLoadRecord(d);if(b=this._getLocation(d,c),e)this.locationToLayer(b,d);else if(this._layerIndex){var f=this.options.getIndexKey.call(this,b,d);f in this._layerIndex&&(this.removeLayer(this._layerIndex[f]),delete this._layerIndex[f])}}},_preloadLocations:function(b){var c=this.options.codeField,d=[],e={};for(var f in b)if(b.hasOwnProperty(f)){var g=b[f],h=a.Util.getFieldValue(g,c);e[h]=g,d.push(h)}if(this.options.getLocation){var i=this,j=function(a,b){i.locationToLayer(b,e[a])};this.options.getLocation(e,c,d,j)}},setDisplayOptions:function(a){return this.options.displayOptions=a,this.reloadData(),this},setDisplayOption:function(b,c){if(this.options.displayOptions=this.options.displayOptions||{},b in this.options.displayOptions){var d=this.options.displayOptions[b];this.options.displayOptions[b]=a.extend({},d,c)}else this.options.displayOptions[b]=c;return this.reloadData(),this},setFilter:function(a){return this.options.filter=a,this.reloadData(),this},setOptions:function(b){return a.setOptions(this,b),this.reloadData(),this},setData:function(a){this._data=a,this.reloadData()},reloadData:function(){return this._layerIndex||(this.clearLayers(),this._addChildLayers()),this._data&&this.addData(this._data),this.fire("legendChanged",this),this},addData:function(b){var c=null!==this.options.recordsField&&this.options.recordsField.length>0?a.Util.getFieldValue(b,this.options.recordsField):b;this.options.getIndexKey&&!this._layerIndex&&(this._layerIndex={},this._boundaryIndex={}),this.options.locationMode===a.LocationModes.CUSTOM&&this.options.preload?this._preloadLocations(c):this._loadRecords(c),this._data=b},locationToLayer:function(a,b){var c=this,d=c.recordToLayer(a,b);d&&c.addLayer(d)},_bindMouseEvents:function(b,c,d){var e=this,f=this.options,g=f.setHighlight,h=f.unsetHighlight,i=f.tooltipOptions,j=function(b){var c=b.target,f=this.options||c.options,h=new a.LegendIcon(d,f,{className:i.className||"leaflet-div-icon",iconSize:i.iconSize,iconAnchor:i.iconAnchor}),j=b.latlng||b.target._latlng,k=new a.Marker(j,{icon:h});c._map.addLayer(k),e.tooltip&&(c._map.removeLayer(e.tooltip),e.tooltip=null),e.tooltip=k,g&&(f=g(f)),c.setStyle&&c.setStyle(f),c.isHighlighted=!0},k=function(a){a.target;e.tooltip&&e.tooltip.setLatLng(a.latlng)},l=function(a){var b=a.target;if(b.isHighlighted){b.isHighlighted=!1,e.tooltip&&(b._map.removeLayer(e.tooltip),e.tooltip=null);var c=this.options||b.options;h&&(c=h(c)),b.setStyle&&b.setStyle(c)}},m=function(a){a.off("mouseover"),a.off("mouseout"),a.off("mousemove"),a.on({mouseover:j,mouseout:l,mousemove:k})},n=function(a){a.eachLayer?a.eachLayer(function(a){n(a)}):m(a)};n(b)},_getDynamicOptions:function(b){var c=a.extend({},this.options.layerOptions),d=this.options.displayOptions||{},e={};if("function"==typeof d)return d.call(this,b,c);for(var f in d){var g,h=d[f],i=a.Util.getFieldValue(b,f),j=h.displayText?h.displayText(i):i;if(e[f]={name:h.displayName,value:j},h.styles)c=a.extend(c,h.styles[i]),h.styles[i]=c;else for(var k in h)g=h[k],c[k]=g.evaluate?g.evaluate(i):g.call?g.call(this,i):g}return{layerOptions:c,legendDetails:e}},_recursiveLayerUpdate:function(a,b){var c=this;a.eachLayer?a.eachLayer(function(a){c._recursiveLayerUpdate(a,b)}):b.call(c,a)},_getIndexedLayer:function(b,c,d,e){var f=this;if(this.options.getIndexKey){var g=this.options.getIndexKey.call(this,c,e);if(g in b){layer=b[g];var h=function(b){d.radius&&b instanceof a.CircleMarker&&b.setRadius(d.radius),b.setStyle(d),b.setLatLng&&b.getLatLng()!==c.center?b.setLatLng(c.center):f._recursiveLayerUpdate(b,function(a){a.redraw()})};a.Util.updateLayer(layer,h),layer.boundaryLayer&&(layer.boundaryLayer=this._styleBoundary(layer.boundaryLayer,d,e))}else layer=this._getLayer(c,d,e),b[g]=layer;if(this.options.getTrack){var i=!layer.trackLayer;layer.trackLayer=this.options.getTrack.call(this,layer,c,layer.trackLayer),i&&this._trackLayer.addLayer(layer.trackLayer)}}else layer=this._getLayer(c,d,e);return layer},recordToLayer:function(b,c){var d,e=a.extend({},this.options.layerOptions),f={},g=this._shouldLoadRecord(c);if(g){var h=this.options.dynamicOptions?this.options.dynamicOptions(c):this._getDynamicOptions(c);e=h.layerOptions,f=h.legendDetails,b&&e&&(e.title=b.text,d=this._getIndexedLayer(this._layerIndex,b,e,c),d&&(this.options.showLegendTooltips&&this._bindMouseEvents(d,e,f),this.options.onEachRecord&&this.options.onEachRecord.call(this,d,c,b,this)))}return d},getLegend:function(a){return this.options.getLegend?this.options.getLegend.call(this,a):this._getLegend(a)},_getLegendElement:function(b){var c,d,e=document.createElement("i"),f=b.displayProperties,g=b.layerOptions,h=b.ignoreProperties,i=b.displayTextFunction,j=b.index,k=b.numSegments,l=b.segmentWidth,m=b.minValue,n=b.maxValue;a.StyleConverter.applySVGStyle(e,g);var o={evaluate:function(a){return b.breaks[a]}};for(var p in f)if(f.hasOwnProperty(p)&&h.indexOf(p)===-1&&(valueFunction=f[p],valueFunction&&(valueFunction.getBounds||f.minValue&&f.maxValue))){var q=valueFunction.getBounds?valueFunction.getBounds():null,r=q?q[0].x:f.minValue,s=q?q[1].x:f.maxValue,t=b.breaks?o:new a.LinearFunction(new a.Point(0,r),new a.Point(k,s));c=r,d=s,i&&(c=i(r),d=i(s)),0===j&&(m.innerHTML=c,n.innerHTML=d);var u=(s-r)/k,v=t.evaluate(j),w=t.evaluate(j+1),x=valueFunction.evaluate?valueFunction.evaluate(v):valueFunction(v),y=valueFunction.evaluate?valueFunction.evaluate(w):valueFunction(w);a.StyleConverter.setCSSProperty(e,p,x),"fillColor"===p&&(b.gradient?e.style.cssText+="background-image:linear-gradient(left , "+x+" 0%, "+y+" 100%);background-image:-ms-linear-gradient(left , "+x+" 0%, "+y+" 100%);background-image:-moz-linear-gradient(left , "+x+" 0%, "+y+" 100%);background-image:-webkit-linear-gradient(left , "+x+" 0%, "+y+" 100%);":e.style.cssText+="background-color:"+x+";"),"color"===p&&(e.style.cssText+="border-top-color:"+x+";border-bottom-color:"+y+";border-left-color:"+x+";border-right-color:"+y+";"),"weight"===p&&(e.style.cssText+="border-top-width:"+x+";border-bottom-width:"+y+";border-left-width:"+x+";border-right-width:"+y+";");var z=b.minX||u*j+r,A=b.maxX||z+u;i&&valueFunction&&(z=i(z),A=i(A)),e.setAttribute("title",z+" - "+A)}return e.style.width=~~l+"px",e},_getLegend:function(b){b=b||this.options.legendOptions||{};var c,d=b.className,e=document.createElement("div"),f=a.DomUtil.create("div","legend",e),g=b.numSegments||10,h=b.width||100,i=this.options.layerOptions||{},j=i.weight||0,k=h/g-2*j,l=this.options.displayOptions||{};d&&a.DomUtil.addClass(f,d),b.title&&(a.DomUtil.create("legend","",f).innerHTML=b.title);var m=function(a){return a};for(var n in l)if(l.hasOwnProperty(n)){var o=l[n];if(!o.excludeFromLegend){var p=o.displayName||n;c=o.displayText;var q=c?c:m,r=o.styles;if(a.DomUtil.create("div","legend-title",f).innerHTML=p,r)f.innerHTML+=new a.CategoryLegend(r).generate();else{var s=a.DomUtil.create("div","data-layer-legend"),t=a.DomUtil.create("div","min-value",s),u=a.DomUtil.create("div","scale-bars",s),v=a.DomUtil.create("div","max-value",s),w=["displayName","displayText","minValue","maxValue"],x=o.breaks,y=[];if(g=b.numSegments||10,x){for(var z=new a.LinearFunction([x[0],0],[x[x.length-1],h]),A=0,B=0,C=1,D=x.length;C<D;++C)B=z.evaluate(x[C]),y.push(B-A-2*j),A=B;g=y.length}for(var E=0;E<g;++E){var F={displayProperties:o,layerOptions:i,ignoreProperties:w,displayTextFunction:q,index:E,numSegments:g,segmentWidth:k,minValue:t,maxValue:v,gradient:b.gradient};x&&y.length>0&&(F.segmentWidth=y[E],F.segmentSize=y[E],F.minX=x[E],F.maxX=x[E+1],F.breaks=x);var G=this._getLegendElement(F);u.appendChild(G)}f.appendChild(s)}}}return e.innerHTML},toGeoJSON:function(){var b=this.feature&&this.feature.geometry&&this.feature.geometry.type;if("MultiPoint"===b)return this.toMultiPoint();var c="GeometryCollection"===b,d=[];return this.eachLayer(function(b){if(b.toGeoJSON){var e=b.toGeoJSON();if("FeatureCollection"===e.type&&e.features)for(var f=0,g=e.features.length;f<g;++f)d.push(e.features[f]);else d.push(c?e.geometry:a.GeoJSON.asFeature(e))}}),c?a.GeoJSON.getFeature(this,{geometries:d,type:"GeometryCollection"}):{type:"FeatureCollection",features:d}}}),a.dataLayer=function(b,c){return new a.DataLayer(b,c)},a.MapMarkerDataLayer=a.DataLayer.extend({_getMarker:function(b,c,d){return new a.MapMarker(b,c)}}),a.mapMarkerDataLayer=function(b,c){return new a.MapMarkerDataLayer(b,c)},a.MarkerDataLayer=a.DataLayer.extend({initialize:function(b,c){this._markerMap={},a.DataLayer.prototype.initialize.call(this,b,c)},options:{recordsField:"features",locationMode:a.LocationModes.LATLNG,latitudeField:"latitude",longitudeField:"longitude",layerOptions:{icon:null},showLegendTooltips:!1},_getMarker:function(b,c,d){return this.options.setIcon&&(c.icon=this.options.setIcon.call(this,d,c)),new a.Marker(b,c)},_getLegendElement:function(a){},_getLegend:function(a){return"<span>No legend available</span>"}}),a.markerDataLayer=function(b,c){return new a.MarkerDataLayer(b,c)},a.PanoramioLayer=a.MarkerDataLayer.extend({statics:{UPLOAD_DATE_FORMAT:"DD MMM YYYY",SIZE_BY_DATE:"date",SIZE_BY_POPULARITY:"popularity",SIZE_BY_NONE:"none",SIZES:{square:[60,60],mini_square:[32,32]},NUM_PHOTOS:50}}),a.PanoramioLayer=a.PanoramioLayer.extend({initialize:function(b){a.MarkerDataLayer.prototype.initialize.call(this,{},b),this._from=0,this._to=a.PanoramioLayer.NUM_PHOTOS,this._calls=[]},options:{recordsField:"photos",latitudeField:"latitude",longitudeField:"longitude",locationMode:a.LocationModes.LATLNG,showLegendTooltips:!1,sizeBy:a.PanoramioLayer.SIZE_BY_DATE,layerOptions:{opacity:1},onEachRecord:function(b,c){var d=c.photo_file_url,e=c.photo_title,f=this,g=c.width,h=c.height,i=2e4;b.on("click",function(j){var k=document.createElement("div"),l=a.DomUtil.create("div","",k);a.DomUtil.addClass(l,"panoramio-content");var m=a.DomUtil.create("img","photo",l);m.setAttribute("onload","this.style.opacity=1;"),m.setAttribute("src",d),m.style.width=g+"px";var n=a.DomUtil.create("div","photo-info",l);n.style.width=g-20+"px",n.innerHTML="<span>"+e+'</span><a class="photo-link" target="_blank" href="'+c.photo_url+'"><img src="http://www.panoramio.com/img/glass/components/logo_bar/panoramio.png" style="height: 14px;"/></a>';var o=a.DomUtil.create("a","author-link",l);o.setAttribute("target","_blank"),o.setAttribute("href",c.owner_url),o.innerHTML="by "+c.owner_name;var p=new a.DivIcon({className:"photo-details",html:k.innerHTML,iconAnchor:[g/2,h/2]}),q=new a.Marker(j.target._latlng,{icon:p,zIndexOffset:i});q.on("click",function(a){f.removeLayer(a.target)}),b.viewedImage=q,f.viewedImage=q,f.addLayer(q)}),this.options.onEachPhoto&&this.options.onEachPhoto.call(this,b,c)},setIcon:function(b,c){var d=a.Util.getFieldValue(b,"photo_title"),e=null;this._sizeFunction&&(e=this._sizeFunction.evaluate(b.index));var f=e?new a.Point(e,e):a.PanoramioLayer.SIZES[this.options.size],g=b.photo_file_url.replace("/medium/","/"+this.options.size+"/"),h=new a.DivIcon({iconSize:f,className:"",html:'<img class="photo" onload="this.style.opacity=1" title="'+d+'" src="'+g+'"/>'});return h},updateInterval:3e5,size:"square",attributionText:'Photos provided by <a href="http://www.panoramio.com"><img src="http://www.panoramio.com/img/glass/components/logo_bar/panoramio.png" style="height: 10px;"/></a>.  Photos provided by <a href="http://www.panoramio.com"><img src="http://www.panoramio.com/img/glass/components/logo_bar/panoramio.png" style="height: 10px;"/></a> are under the copyright of their owners',refreshEvents:"moveend",photoSet:"public"},includes:a.Mixin.Events,onAdd:function(b){a.DataLayer.prototype.onAdd.call(this,b),b.attributionControl&&b.attributionControl.addAttribution(this.options.attributionText);var c=this,d=function(b){c._from=0,c._to=a.PanoramioLayer.NUM_PHOTOS,c.fire("requestingPhotos"),c._call&&clearTimeout(c._call);var d=function(){c.requestPhotos()};c._call=setTimeout(d,1e3)};this.requestPhotos(),this._interval=setInterval(d,this.options.updateInterval),this._resetFunction=d,b.on(this.options.refreshEvents,d)},onRemove:function(b){a.DataLayer.prototype.onRemove.call(this,b),b.attributionControl&&b.attributionControl.removeAttribution(this.options.attributionText),this._interval&&(clearInterval(this._interval),this._interval=null),b.off(this.options.refreshEvents,this._resetFunction)},calculateSizeByDate:function(b){for(var c=b.photos,d=[],e=0,f=c.length;e<f;++e){var g=c[e],h=moment(g.upload_date,a.PanoramioLayer.UPLOAD_DATE_FORMAT);d.push(h),c[e].index=h}d.sort(function(a,b){return a-b});var i=a.PanoramioLayer.SIZES[this.options.size][0];return this._sizeFunction=new a.LinearFunction([d[0],i/2],[d[d.length-1],i]),b},calculateSizeByPopularity:function(b){for(var c=b.photos,d=0,e=c.length;d<e;++d)c[d].index=d;var f=a.PanoramioLayer.SIZES[this.options.size][0];return this._sizeFunction=new a.LinearFunction([0,f/2],[c.length,f]),b},next:function(){this._from=this._to,this._to=this._from+a.PanoramioLayer.NUM_PHOTOS,this.requestPhotos()},previous:function(){this._to=this._from,this._from=this._from-a.PanoramioLayer.NUM_PHOTOS,this.requestPhotos()},requestJsonp:function(a,b,c){var d=this,e="function"+(new Date).getTime(),f=[];b.callback="window.LeafletDvfJsonpCallbacks."+e;for(var g in b)b.hasOwnProperty(g)&&f.push(g+"="+encodeURIComponent(b[g]));return a+=(a.indexOf("?")>0?"&":"?")+f.join("&"),"undefined"==typeof window.LeafletDvfJsonpCallbacks&&(window.LeafletDvfJsonpCallbacks={}),window.LeafletDvfJsonpCallbacks[e]=function(a){c.call(d,a),delete window.LeafletDvfJsonpCallbacks[e]},this.jsonpScript&&(document.head.removeChild(this.jsonpScript),this.jsonpScript=null),this.jsonpScript=document.createElement("script"),this.jsonpScript.setAttribute("type","text/javascript"),this.jsonpScript.setAttribute("async","true"),this.jsonpScript.setAttribute("src",a),document.head.appendChild(this.jsonpScript),{abort:function(){e in window.LeafletDvfJsonpCallbacks&&(window.LeafletDvfJsonpCallbacks[e]=function(){delete window.LeafletDvfJsonpCallbacks[e]})}}},requestPhotos:function(){for(var b=this,c=this._map.getBounds(),d=c.getSouthWest(),e=c.getNorthEast();b._calls.length>0;)b._calls.pop().abort();var f=this.requestJsonp("http://www.panoramio.com/map/get_panoramas.php",{set:this.options.photoSet,from:b._from,to:b._to,minx:d.lng,miny:d.lat,maxx:e.lng,maxy:e.lat,size:"medium",mapfilter:"true"},function(c){b._count=c.count,moment&&b.options.sizeBy===a.PanoramioLayer.SIZE_BY_DATE?c=b.calculateSizeByDate(c):b.options.sizeBy===a.PanoramioLayer.SIZE_BY_POPULARITY&&(c=b.calculateSizeByPopularity(c)),b.fire("photosAvailable",c),b.clearLayers(),b.addData(c)});b._calls.push(f)}}),a.panoramioLayer=function(b){return new a.PanoramioLayer(b)},a.GeohashDataLayer=a.DataLayer.extend({initialize:function(b,c){a.DataLayer.prototype.initialize.call(this,b,c)},options:{recordsField:"features",locationMode:a.LocationModes.GEOHASH,geohashField:"geohash",displayField:null,displayOptions:null,layerOptions:{weight:1,color:"#000"},getIndexKey:function(a,b){return a.text}},_getLayer:function(b,c,d){return new a.Rectangle(b.location,c)}}),a.geohashDataLayer=function(b,c){return new a.GeohashDataLayer(b,c)},a.ChoroplethDataLayer=a.DataLayer.extend({initialize:function(b,c){a.DataLayer.prototype.initialize.call(this,b,c)},options:{recordsField:"features",locationMode:a.LocationModes.COUNTRY,codeField:"ISO",displayField:null,displayOptions:null,layerOptions:{weight:1,color:"#000"},maxZoom:16,backgroundLayer:!0},_getLayer:function(b,c,d){return b.location instanceof a.LatLng?(this._markerFunction=this.options.getMarker||this._getMarker,b.location=this._markerFunction.call(this,b.location,c,d)):b.location instanceof a.LatLngBounds&&(b.location=new a.Rectangle(b.location,c)),b.location.setStyle&&(c.gradient=!(b.location instanceof a.Polyline)&&c.gradient,b.location.setStyle(c)),b.location}}),a.choroplethDataLayer=function(b,c){return new a.ChoroplethDataLayer(b,c)},a.ChartDataLayer=a.DataLayer.extend({options:{showLegendTooltips:!1},initialize:function(b,c){a.DataLayer.prototype.initialize.call(this,b,c)},_getLayer:function(b,c,d){var e=this._addBoundary(b,c,d);b=this._processLocation(b);var f=this.options.chartOptions,g=this.options.tooltipOptions,h={};h=c,h.data={},h.chartOptions=f;for(var i in this.options.chartOptions)h.data[i]=this.options.getFieldValue?this.options.getFieldValue.call(this,d,i):a.Util.getFieldValue(d,i);for(i in g)h[i]=g[i];var j;return b&&(this._markerFunction=this.options.getMarker||this._getMarker,j=this._markerFunction.call(this,b,h,d),j.boundaryLayer=e),j},_getMarker:function(a,b,c){},_getLegend:function(b){var c=(a.DataLayer.prototype._getLegend.call(this,b),new a.CategoryLegend(this.options.chartOptions));return b=b||this.options.legendOptions,c.generate(b)}}),a.BarChartDataLayer=a.ChartDataLayer.extend({initialize:function(b,c){a.ChartDataLayer.prototype.initialize.call(this,b,c)},_getMarker:function(b,c,d){return new a.BarChartMarker(b,c)}}),a.barChartDataLayer=function(b,c){return new a.BarChartDataLayer(b,c)},a.RadialBarChartDataLayer=a.ChartDataLayer.extend({initialize:function(b,c){a.ChartDataLayer.prototype.initialize.call(this,b,c)},_getMarker:function(b,c,d){return new a.RadialBarChartMarker(b,c)}}),a.radialBarChartDataLayer=function(b,c){return new a.RadialBarChartDataLayer(b,c)},a.PieChartDataLayer=a.ChartDataLayer.extend({initialize:function(b,c){a.ChartDataLayer.prototype.initialize.call(this,b,c)},_getMarker:function(b,c,d){return new a.PieChartMarker(b,c)}}),a.pieChartDataLayer=function(b,c){return new a.PieChartDataLayer(b,c)},a.CoxcombChartDataLayer=a.ChartDataLayer.extend({initialize:function(b,c){a.ChartDataLayer.prototype.initialize.call(this,b,c)},_getMarker:function(b,c,d){return new a.CoxcombChartMarker(b,c)}}),a.coxcombChartDataLayer=function(b,c){return new a.CoxcombChartDataLayer(b,c)},a.StackedRegularPolygonDataLayer=a.ChartDataLayer.extend({initialize:function(b,c){a.ChartDataLayer.prototype.initialize.call(this,b,c)},_getMarker:function(b,c,d){return new a.StackedRegularPolygonMarker(b,c)}}),a.stackedRegularPolygonDataLayer=function(b,c){return new a.StackedRegularPolygonDataLayer(b,c)},a.StackedPieChartDataLayer=a.ChartDataLayer.extend({initialize:function(b,c){a.ChartDataLayer.prototype.initialize.call(this,b,c)},_getMarker:function(b,c,d){return new a.StackedPieChartMarker(b,c)}}),a.stackedPieChartDataLayer=function(b,c){return new a.StackedPieChartDataLayer(b,c)},a.RadialMeterMarkerDataLayer=a.DataLayer.extend({options:{showLegendTooltips:!1},initialize:function(b,c){a.DataLayer.prototype.initialize.call(this,b,c)},_getLayer:function(b,c,d){this._addBoundary(b,c,d),b=this._processLocation(b);var e=this.options.chartOptions,f=this.options.tooltipOptions,g=this.options.displayOptions,h={};h=c,h.data={},h.chartOptions=e,h.displayOptions=g;for(var i in this.options.chartOptions)h.data[i]=a.Util.getFieldValue(d,i);for(i in f)h[i]=f[i];var j;return b&&(j=this._getMarker(b,h,d)),j},_getMarker:function(b,c,d){return new a.RadialMeterMarker(b,c)}}),a.radialMeterMarkerDataLayer=function(b,c){return new a.RadialMeterMarkerDataLayer(b,c)}},window),function(a,b){"function"==typeof define&&define.amd?define(["leaflet"],a):"object"==typeof exports&&(module.exports=a(require("leaflet"))),"undefined"!=typeof b&&b.L&&(b.L.YourPlugin=a(L))}(function(a){a.CalloutLine=a.Path.extend({statics:{LINESTYLE:{ARC:"arc",ANGLE:"angle",STRAIGHT:"straight"},DIRECTION:{NE:"ne",NW:"nw",SE:"se",SW:"sw"}}}),a.CalloutLine=a.CalloutLine.extend({initialize:function(b,c){a.setOptions(this,c),this._latlng=b},options:{size:new a.Point(60,30),position:new a.Point(0,0),color:"#FFFFFF",opacity:1,weight:2,fillColor:"#000000",fill:!1,gradient:!1,dropShadow:!1,direction:a.CalloutLine.DIRECTION.NE,lineStyle:a.CalloutLine.LINESTYLE.ANGLE,lineCap:"butt",lineJoin:"miter",arrow:!1},projectLatLngs:function(){this._point=this._map.latLngToLayerPoint(this._latlng),this._points=this._getPoints()},_project:function(){this.projectLatLngs(),this._updateBounds()},_updateBounds:function(){var b=this._map,c=b.project(this._latlng),d=new a.Point(c.x+this.options.position.x,c.y+this.options.position.y),e=new a.Point(d.x+this.options.size.x,d.y-this.options.size.y);this._pxBounds=new a.Bounds(d,e)},_update:function(){this._map&&this._renderer._setPath(this,this.getPathString())},getEndPoint:function(){return this._project(),this._points[this._points.length-1]},_getPathAngle:function(){return new a.SVGPathBuilder(this._points,[],{closePath:!1}).build(6)},_getPathArc:function(){var b=(this.options.direction||a.CalloutLine.DIRECTION.NE).toLowerCase(),c=b[0],d="n"===c?-1:1,e=this._points[0],f=this._points[this._points.length-1],g=["M",e.x,",",e.y," Q",e.x,",",e.y+d*this.options.size.y," ",f.x,",",f.y];return g.join(" ")},_getPoints:function(){var b=this._point.x+this.options.position.x,c=this._point.y+this.options.position.y,d=this.options.size.x,e=this.options.size.y,f=(this.options.direction||a.CalloutLine.DIRECTION.NE).toLowerCase(),g=[],h=f[1],i=f[0],j="w"===h?-1:1,k="n"===i?-1:1;g.push(new a.Point(b,c));var l=c+k*e,m=d/2,n=Math.atan(e/m);if(this.options.lineStyle===a.CalloutLine.LINESTYLE.ARC?n=Math.atan(Math.pow(e,2)/m):this.options.lineStyle===a.CalloutLine.LINESTYLE.STRAIGHT&&(n=Math.atan(e/d)),this._angle=n,this.options.lineStyle!==a.CalloutLine.LINESTYLE.STRAIGHT){var o=new a.Point(b+j*m,l);g.push(o)}var p=new a.Point(b+j*d,l);return g.push(p),g},getBounds:function(){var b=this._map,c=b.project(this._latlng),d=new a.Point(c.x+this.options.position.x,c.y+this.options.position.y),e=new a.Point(d.x+this.options.size.x,d.y-this.options.size.y),f=b.unproject(d),g=b.unproject(e);return new a.LatLngBounds(f,g)},setLatLng:function(a){this._latlng=a,this.redraw()},getLatLng:function(){return this._latlng},getPathString:function(){this._path.setAttribute("shape-rendering","geometricPrecision");var b=this.options.lineStyle||a.CalloutLine.LINESTYLE.ANGLE,c="";return c+=b===a.CalloutLine.LINESTYLE.ANGLE||b===a.CalloutLine.LINESTYLE.STRAIGHT?this._getPathAngle():this._getPathArc()}}),a.calloutLine=function(b,c){return new a.CalloutLine(b,c)},a.Callout=a.LayerGroup.extend({options:{color:"#FFFFFF",fillColor:"#FFFFFF"},initialize:function(b,c){a.Util.setOptions(this,c),a.LayerGroup.prototype.initialize.call(this,c),this._latlng=b},onAdd:function(b){a.LayerGroup.prototype.onAdd.call(this,b),this.addLayers()},onRemove:function(b){a.LayerGroup.prototype.onRemove.call(this,b),this.clearLayers()},addArrow:function(b,c,d){if(this.options.arrow){b=a.LatLng.RAD_TO_DEG*b;var e=this.options.numberOfSides||3,f=this.options.radius||6,g=180/e,h={se:g+b,sw:180+g-b,nw:180+g+b,ne:g-b},i=h[c],j=new a.RegularPolygonMarker(this._latlng,{position:d,numberOfSides:e,rotation:i,fillColor:this.options.fillColor,color:this.options.color,gradient:this.options.gradient,weight:this.options.weight,opacity:this.options.opacity,fillOpacity:this.options.fillOpacity,radius:f,lineCap:"butt",lineJoin:"miter"});this.addLayer(j)}},addLine:function(){var b={};for(var c in this.options)"icon"!==c&&(b[c]=this.options[c]);var d=new a.CalloutLine(this._latlng,b);return this.addLayer(d),d},addIcon:function(b,c){var d=this.options.size,e=this.options.icon,f=e.options.iconSize,g=b[0],h=b[1],i="w"===h?f.x+d.x-c.x:-1*(d.x+c.x),j="n"===g?f.y/2+d.y-c.y:-1*(-f.y/2+d.y+c.y);e.options.iconAnchor=new a.Point(i,j);var k=new a.Marker(this._latlng,{icon:e});this.addLayer(k)},addLayers:function(){var b,c=(this.options.direction||"ne").toLowerCase(),d=this.options.position||new a.Point(0,0);b=this.addLine(),this.addIcon(c,d),this.addArrow(b._angle,c,d)}}),a.callout=function(b,c){return new a.Callout(b,c)},a.FlowLine=a.DataLayer.extend({statics:{LINE_FUNCTION:function(b,c,d){return new a.Polyline([b,c],d)},LINE_FUNCTION_INTERPOLATED:function(b,c,d){var e=this._map.latlngToLayerPoint(b),f=this._map.latlngToLayerPoint(c),g=new a.LinearFunction(e,f),h=Math.ceil(e.distanceTo(f)/d.interpolationOptions.segmentLength);g.samplePoints(h)}}}),a.FlowLine=a.FlowLine.extend({initialize:function(b,c){a.Util.setOptions(this,c),a.DataLayer.prototype.initialize.call(this,b,c)},options:{getLine:a.FlowLine.LINE_FUNCTION,showLegendTooltips:!0,setHighlight:function(a){return a.opacity=a.opacity||1,a.opacity/=1.5,a},unsetHighlight:function(a){return a.opacity=a.opacity||.66,a.opacity*=1.5,a}},onEachSegment:function(b,c,d){var e={};if(this.options.timeField){var f=a.Util.getFieldValue(b,this.options.timeField),g=a.Util.getFieldValue(c,this.options.timeField),h=this.options.timeFormat,i=h?moment(f,h):moment(f),j=h?moment(g,h):moment(g),k=j.valueOf()-i.valueOf();e.time=k}for(var l in this.options.displayOptions){var m=a.Util.getFieldValue(b,l),n=a.Util.getFieldValue(c,l),o=n-m,p=o/m*100;e[l]={from:m,to:n,change:o,percentChange:p},e.time&&(e[l].changeOverTime=o/e.time);
}var q,r=d.getLatLngs(),s=r[0].distanceTo(r[1]);e.time&&(q=s/(1e3*e.time)),this.options.onEachSegment&&this.options.onEachSegment.call(this,b,c,d,e,s,q)},_loadRecords:function(a){var b=[];this._lastRecord=null;for(var c in a)if(a.hasOwnProperty(c)){var d=a[c];d=this.options.deriveProperties?this.options.deriveProperties(d):d,b=this._addRecord(d,c,b)}for(;b.length>0;)this.addLayer(b.pop())},addRecord:function(a){return this._addRecord(a),this},_addRecord:function(a,b,c){var d=this._getLocation(a,b),e=this.options.layerOptions;if(d){var f,g=this._getLayer(d,e,a),h=!0;this.options.includeLayer&&(h=this.options.includeLayer(a)),this._lastRecord&&h&&(e=this._getDynamicOptions(this._lastRecord),f=this.options.getLine.call(this,this._lastMarker.getLatLng(),g.getLatLng(),e.layerOptions),this.addLayer(f),this.options.showLegendTooltips&&this._bindMouseEvents(f,e.layerOptions,e.legendDetails),this.onEachSegment(this._lastRecord,a,f)),h&&(this._lastRecord=a,this._lastMarker=g)}return c}}),a.flowLine=function(b,c){return new a.FlowLine(b,c)},a.ArcedFlowLine=a.FlowLine.extend({options:{getLine:function(b,c,d){return new a.ArcedPolyline([b,c],d)}},initialize:function(b,c){a.FlowLine.prototype.initialize.call(this,b,c)}}),a.arcedFlowLine=function(b,c){return new a.ArcedFlowLine(b,c)},a.ArcedPolyline=a.Path.extend({includes:a.extend({},TextFunctions,PolylineFunctions),initialize:function(b,c){a.setOptions(this,c),this._latlngs=b},options:{distanceToHeight:new a.LinearFunction([0,5],[1e3,200]),color:"#FFFFFF",opacity:1,weight:1,fillColor:"#000000",fill:!1,gradient:!1,dropShadow:!1,optimizeSpeed:!1,mode:"C"},_project:function(){this._points=[];for(var a=0,b=this._latlngs.length;a<b;++a)this._points.push(this._map.latLngToLayerPoint(this._latlngs[a]))},_update:function(){this._map&&this._renderer._setPath(this,this.getPathString())},getBounds:function(){for(var b=new a.LatLngBounds,c=0,d=this._latlngs.length;c<d;++c)b.extend(this._latlngs[c]);return b},setLatLngs:function(a){return this._latlngs=a,this.redraw(),this},getLatLngs:function(){return this._latlngs},drawSegment:function(b,c){var d,e,f=Math.sqrt(Math.pow(c.x-b.x,2)+Math.pow(c.y-b.y,2)),g=this.options.distanceToHeight.evaluate(f),h=b,i=c,j=[];return this._angle=Math.atan(2*g/(.5*f)),"Q"===this.options.mode?(e=new a.LinearFunction(b,c),h=e.getPointAtPercent(.5)):this.options.controlPointOffsets&&(e=new a.LinearFunction(b,c),h=e.getPointAtPercent(this.options.controlPointOffsets.x),i=e.getPointAtPercent(1-this.options.controlPointOffsets.y)),d="C"===this.options.mode?["C",h.x,",",h.y-g,i.x,",",i.y-g]:["Q",h.x,",",h.y-g],j=["M",b.x,",",b.y].concat(d).concat([c.x,",",c.y]),e=null,j.join(" ")},getPathString:function(){this.options.optimizeSpeed&&this._path.setAttribute("shape-rendering","optimizeSpeed");for(var a=[],b=0,c=this._points.length-1;b<c;++b)a.push(this.drawSegment(this._points[b],this._points[b+1]));return a.join("")}}),a.arcedPolyline=function(b,c){return new a.ArcedPolyline(b,c)}},window),function(a,b){"function"==typeof define&&define.amd?define(["leaflet"],a):"object"==typeof exports&&(module.exports=a(require("leaflet"))),"undefined"!=typeof b&&b.L&&(b.L.YourPlugin=a(L))}(function(a){a.Control.Legend=a.Control.extend({options:{position:"bottomright",autoAdd:!0},onAdd:function(b){var c="leaflet-control-legend",d=a.DomUtil.create("div",c),e=this;return this.options.autoAdd&&(b.on("layeradd",function(a){var b=a.layer;e.addLayer(b)}),b.on("layerremove",function(a){var b=a.layer;e.removeLayer(b)})),this.toggleSize=a.bind(this.toggleSize,this),a.DomEvent.addListener(d,"mouseover",this.toggleSize).addListener(d,"mouseout",this.toggleSize).addListener(d,"touchstart",this.toggleSize).addListener(d,"touchend",this.toggleSize).addListener(d,"mousedown",a.DomEvent.stopPropagation).addListener(d,{mousewheel:a.DomEvent.stopPropagation,MozMousePixelScroll:a.DomEvent.preventDefault}).addListener(d,"click",a.DomEvent.stopPropagation).addListener(d,"click",a.DomEvent.preventDefault),d},clear:function(){this._container.innerHTML=""},toggleSize:function(){a.DomUtil.hasClass(this._container,"larger")?a.DomUtil.removeClass(this._container,"larger"):a.DomUtil.addClass(this._container,"larger")},redrawLayer:function(a){this.removeLayer(a),this.addLayer(a)},addLayer:function(b){var c=a.Util.stamp(b),d=this;b.getLegend&&(this.addLegend(c,b.getLegend()),b.on("legendChanged",function(){d.redrawLayer(b)}))},removeLayer:function(b){var c=a.Util.stamp(b);if(b.getLegend){var d=document.getElementById(c);d.parentNode.removeChild(d),b.off("legendChanged")}},addLegend:function(b,c){var d=this._container,e=document.getElementById(b);e||(e=a.DomUtil.create("div","",d),e.id=b),e.innerHTML=c}}),a.control.legend=function(b){return new a.Control.Legend(b)}},window),function(a,b){"function"==typeof define&&define.amd?define(["leaflet"],a):"object"==typeof exports&&(module.exports=a(require("leaflet"))),"undefined"!=typeof b&&b.L&&(b.L.YourPlugin=a(L))}(function(a){a.SeriesMarker=a.Path.extend({initialize:function(b,c){a.setOptions(this,c),this._latlng=b},options:{fill:!1,size:new a.Point(80,80),position:{x:0,y:0},weight:1,color:"#000",opacity:1},setLatLng:function(a){return this._latlng=a,this.redraw()},_project:function(){this._point=this._map.latLngToLayerPoint(this._latlng),this._points=this._getPoints()},_update:function(){this._map&&this._renderer._setPath(this,this.getPathString())},getBounds:function(){var b=this._map,c=b.project(this._latlng),d=new a.Point(c.x,c.y),e=new a.Point(c.x+this.options.size.x,c.y-this.options.size.y),f=b.unproject(d),g=b.unproject(e);return new a.LatLngBounds(f,g)},getLatLng:function(){return this._latlng},getPathString:function(){return new a.SVGPathBuilder(this._points,null,{closePath:this.options.fill}).build(6)},getDataPoint:function(a){return _.find(this._seriesPoints,function(b){return b.x===a})},getClosestPathPoint:function(a){var b,c=this._points,d=-1,e=_.find(c,function(b,c){var e=b.x>=a;return e&&(d=c),e});if(e)if(e.x===a)b=e;else if(d>0){var f=c[d-1],g=Math.abs(e.x-a),h=Math.abs(f.x-a);b=g<h?e:f}return b},getClosestPoint:function(a){var b,c=this._seriesPoints,d=-1;a=this._reverseXTransform.evaluate(a);var e=_.find(c,function(b,c){var e=b.x>=a;return e&&(d=c),e});if(e)if(e.x===a)b=e;else if(d>0){var f=c[d-1],g=Math.abs(e.x-a),h=Math.abs(f.x-a);b=g<h?e:f}return b},_getPoints:function(){var b=this.options,c=b.size,d=b.xRange?b.xRange[0]:b.minX,e=b.xRange?b.xRange[1]:b.maxX,f=b.yRange?b.yRange[0]:b.minY,g=b.yRange?b.yRange[1]:b.maxY,h=new a.LinearFunction([d,0],[e,c.x]),i=new a.LinearFunction([f,0],[g,c.y]);this._reverseXTransform=new a.LinearFunction([0,d],[c.x,e]),this._reverseYTransform=new a.LinearFunction([0,f],[c.y,g]);var j,k,l,m=b.xField||"x",n=b.yField||"y",o=[],p=b.value;this._seriesPoints=[];for(var q in p)p.hasOwnProperty(q)&&(j=p[q],k=a.Util.getFieldValue(j,m),l=a.Util.getFieldValue(j,n),k=isNaN(k)?moment(k).unix():Number(k),this._seriesPoints.push(new a.Point(k,l)),k=h.evaluate(k),l=i.evaluate(l),o.push(new a.Point(this._point.x+b.position.x+k-c.x/2,this._point.y+b.position.y-l)));if(this._seriesPoints=_.sortBy(this._seriesPoints,function(a){return a.x}),o=_.sortBy(o,function(a){return a.x}),b.fill){var r=i.evaluate(f);o.unshift(new a.Point(this._point.x+b.position.x+h.evaluate(d)-c.x/2,this._point.y+b.position.y-r)),o.push(new a.Point(this._point.x+b.position.x+h.evaluate(e)-c.x/2,this._point.y+b.position.y-r))}return o}}),a.Line=a.Path.extend({initialize:function(b,c){a.setOptions(this,c),this._points=b},_project:function(){},_update:function(){this._map&&this._renderer._setPath(this,this.getPathString())},getPathString:function(){var b=new a.SVGPathBuilder(this._points,null,{closePath:!1}).build(6);return b}}),a.SparklineMarker=a.ChartMarker.extend({initialize:function(b,c){a.setOptions(this,c),a.ChartMarker.prototype.initialize.call(this,b,c)},options:{weight:1,opacity:1,dataPointHighlightStyle:{weight:1,opacity:1,color:"#1E90FF",lineCap:"square",dropShadow:!1,dashArray:[5,2]}},_highlight:function(a){return a.weight&&(a.weight*=2),a},_unhighlight:function(a){return a.weight&&(a.weight/=2),a},_bindMouseEvents:function(b){var c=this,d=this.options.tooltipOptions;b.on("mousemove",function(e){var f,g=this.options,h=g.key,i=g.value,j=e.layerPoint,k=j.x-this._point.x,l=(j.y-this._point.y,g.iconSize),m=5;g.marker&&c.removeLayer(g.marker),g.lines&&_.each(g.lines,function(a){c.removeLayer(a)});var n=b.getClosestPoint(k+g.position.x+c.options.size.x/2),o=b.getClosestPathPoint(j.x);b.getBounds();if(n){i={x:n.x,y:n.y},f=new a.Point((-m),l.y+m);var p={},q=function(a){return'<div><div><span class="xvalue">'+a.x+'</span><span class="separator">:</span><span class="yvalue">'+a.y+"</span></div></div>"},r=g.displayText?g.displayText(i):q(i);p[h]={name:g.displayName,value:r};var s=new a.LegendIcon(p,g,{className:"leaflet-div-icon",iconSize:d?d.iconSize:l,iconAnchor:f}),t=c._map.layerPointToLatLng(o);g.marker=new a.Marker(t,{icon:s}),g.lines=[new a.Line([new a.Point(o.x,b._point.y),new a.Point(o.x,o.y)],c.options.dataPointHighlightStyle),new a.Line([new a.Point(o.x,o.y),new a.Point(b._point.x+g.position.x-c.options.size.x/2,o.y)],c.options.dataPointHighlightStyle)],c.addLayer(g.marker),_.each(g.lines,function(a){c.addLayer(a)})}}),b.on("mouseover",function(a){var b=this.options;b=c._highlight(b),this.initialize(c._latlng,b),this.redraw(),this.setStyle(b)}),b.on("mouseout",function(a){var b=this.options;b=c._unhighlight(b),this.initialize(c._latlng,b),this.redraw(),this.setStyle(b),b.lines&&_.each(b.lines,function(a){c.removeLayer(a)}),c.removeLayer(b.marker)})},_loadComponents:function(){var b,c,d=this.options.chartOptions,e=this.options.data;this.options.size;for(var f in e)if(e.hasOwnProperty(f)){b=e[f],c=d[f],c=a.Util.extend({},this.options,c),c.xField="0",c.yField="1",c.key=f,c.value=b;var g=new a.SeriesMarker(this._latlng,c);this._bindMouseEvents(g),this.addLayer(g)}}}),a.SparklineDataLayer=a.ChartDataLayer.extend({initialize:function(b,c){a.ChartDataLayer.prototype.initialize.call(this,b,c)},_preProcessRecords:function(b){var c,d,e,f,g,h,i=[Number.MAX_VALUE,Number.MIN_VALUE],j=[Number.MAX_VALUE,Number.MIN_VALUE],k={},l=[],m=this.options.xField||"x",n=this.options.yField||"y",o=this.options.seriesField,p=this.options.filter||this.options.includeLayer,q={};for(h in b)if(b.hasOwnProperty(h)){c=b[h];var r=!p||p.call(this,c);if(r)if(o){d=a.Util.getFieldValue(c,o),_.isObject(d)&&(d=_.pairs(d));for(e in this.options.chartOptions){q={};var s=this.options.chartOptions[e];for(g in d)d.hasOwnProperty(g)&&(f=d[g],x=a.Util.getFieldValue(f,s.xField||m),y=a.Util.getFieldValue(f,s.yField||n),isNaN(x)&&(x=moment(x).unix()),x=Number(x),k[x]=x,i[0]=Math.min(i[0],x),i[1]=Math.max(i[1],x),j[0]=Math.min(j[0],y),j[1]=Math.max(j[1],y),q[x]=y);l[h]=l[h]||c,a.Util.setFieldValue(l[h],e,q)}}else for(e in this.options.chartOptions){d=a.Util.getFieldValue(c,e),_.isObject(d)&&(d=_.pairs(d)),q={};var t=this.options.chartOptions[e];for(g in d)d.hasOwnProperty(g)&&(f=d[g],x=a.Util.getFieldValue(f,t.xField||m),y=a.Util.getFieldValue(f,t.yField||n),f.x?(x=f.x,y=f.y):_.isArray(f)?(x=f[0],y=f[1]):(x=h,y=f),isNaN(x)&&(x=moment(x).unix()),x=Number(x),k[x]=x,i[0]=Math.min(i[0],x),i[1]=Math.max(i[1],x),j[0]=Math.min(j[0],y),j[1]=Math.max(j[1],y),q[x]=y);l[h]=l[h]||c,a.Util.setFieldValue(l[h],e,q)}}k=_.sortBy(_.keys(k),function(a){return a});for(h in l){var u=l[h];for(e in this.options.chartOptions){for(var v=a.Util.getFieldValue(u,e),w=0;w<k.length;++w){var x=k[w];x in v||(v[x]=0)}a.Util.setFieldValue(l[h],e,_.chain(v).pairs().sortBy(function(a){return a}).value())}}return this.options.layerOptions.minX=i[0],this.options.layerOptions.maxX=i[1],this.options.layerOptions.minY=Math.min(0,j[0]),this.options.layerOptions.maxY=j[1],this.options.xField="0",this.options.yField="1",l},_getMarker:function(b,c){return new a.SparklineMarker(b,c)}}),a.sparklineDataLayer=function(b,c){return new a.SparklineDataLayer(b,c)},a.WordCloudMarker=a.ChartMarker.extend({initialize:function(b,c){a.setOptions(this,c),a.ChartMarker.prototype.initialize.call(this,b,c)},options:{},_loadComponents:function(){}}),a.wordCloudMarker=function(b,c){return new a.WordCloudMarker(b,c)},a.WordCloudDataLayer=a.ChartDataLayer.extend({initialize:function(b,c){a.ChartDataLayer.prototype.initialize.call(this,b,c)},_preProcessRecords:function(a){return a},_getMarker:function(b,c){return new a.WordCloudMarker(b,c)}}),a.wordCloudDataLayer=function(b,c){return new a.WordCloudDataDataLayer(b,c)};a.Graph=a.DataLayer.extend({statics:{EDGESTYLE:{STRAIGHT:function(b,c){return new a.Polyline([b,c])},ARC:function(b,c){return new a.ArcedPolyline([b,c])}}}}),a.Graph=a.Graph.extend({options:{getEdge:a.Graph.EDGESTYLE.STRAIGHT},_getLayer:function(a,b,c){return a.location.setStyle(b),a.location},_getLocation:function(b,c){var d,e=this.options.fromField,f=this.options.toField,g=a.Util.getFieldValue(b,e),h=a.Util.getFieldValue(b,f),i=this.options.locationMode.call(this,g,g),j=this.options.locationMode.call(this,h,h);if(i&&j){var k=i.center,l=j.center;if(k&&l){var m=this.options.getEdge.call(this,k,l),n=new a.LatLngBounds(new a.LatLng(Math.min(k.lat,l.lat),Math.min(k.lng,l.lng)),new a.LatLng(Math.max(k.lat,l.lat),Math.max(k.lng,l.lng)));d={center:n.getCenter(),location:m,text:g+" - "+h}}}return d}}),a.WeightedLineSegment=a.Path.extend({options:{polygon:!0},initialize:function(b,c,d){a.setOptions(this,d),this._weightedPoint1=b,this._weightedPoint2=c,this._latlngs=[]},_project:function(){var a=this;this._points=this._getPoints(),("undefined"!=typeof this.options.fill&&this.options.fill&&this.options.gradient||this.options.stroke&&!this.options.fill&&this.options.gradient)&&a._setGradient()},_update:function(){this._map&&this._renderer._setPath(this,this.getPathString())},getLatLngs:function(){var a=this._weightedPointToPoint(this._weightedPoint1),b=this._weightedPointToPoint(this._weightedPoint2),c=a[1],d=b[1];return[this._map.layerPointToLatLng(c),this._map.layerPointToLatLng(d)]},projectLatlngs:function(){var a=this;this._points=this._getPoints(),("undefined"!=typeof this.options.fill&&this.options.fill&&this.options.gradient||this.options.stroke&&!this.options.fill&&this.options.gradient)&&a._setGradient()},_setGradient:function(){var b,c=this._points[1],d=this._points[4],e=d.x-c.x,f=d.y-c.y;if(this.options.gradient&&(this.options.gradient.gradientUnits=this.options.gradient.gradientUnits||"objectBoundingBox",0!==e||0!==f)){if("objectBoundingBox"===this.options.gradient.gradientUnits){var g=Math.atan(f/e),h=e/Math.abs(e);f/Math.abs(f);if(c=new a.Point(50+50*Math.cos(g+Math.PI),50+50*Math.sin(g+Math.PI)),d=new a.Point(50+50*Math.cos(g),50+50*Math.sin(g)),h<0){var i=c;c=d,d=i}b=[[c.x.toFixed(2)+"%",c.y.toFixed(2)+"%"],[d.x.toFixed(2)+"%",d.y.toFixed(2)+"%"]]}else b=[[c.x.toFixed(2),c.y.toFixed(2)],[d.x.toFixed(2),d.y.toFixed(2)]];var j=this.options.weightToColor?this.options.weightToColor.evaluate(this._weightedPoint1.lineWeight):this._weightedPoint1.fillColor||this._weightedPoint1.color,k=this.options.weightToColor?this.options.weightToColor.evaluate(this._weightedPoint2.lineWeight):this._weightedPoint2.fillColor||this._weightedPoint2.color,l=this.options.weightToOpacity?this.options.weightToOpacity.evaluate(this._weightedPoint1.lineWeight):1,m=this.options.weightToOpacity?this.options.weightToOpacity.evaluate(this._weightedPoint2.lineWeight):1;this.options.gradient={gradientUnits:this.options.gradient.gradientUnits,vector:b,stops:[{offset:"0%",style:{color:j,opacity:l}},{offset:"100%",style:{color:k,opacity:m}}]},this._renderer._createGradient(this)}},_weightedPointToPoint:function(b){var c=[];this._latlngs.push(b.latlng);var d=this._map.latLngToLayerPoint(b.latlng),e=b.lineWeight/2,f=b.angle,g=f+Math.PI,h=new a.Point(d.x+Math.cos(f)*e,d.y+Math.sin(f)*e),i=new a.Point(d.x+Math.cos(g)*e,d.y+Math.sin(g)*e);return c=[h,d,i]},_getPoints:function(){var b=[],c=this._weightedPointToPoint(this._weightedPoint1),d=this._weightedPointToPoint(this._weightedPoint2);if(this.options.polygon){var e=new a.LinearFunction(c[0],d[0]),f=new a.LinearFunction(c[1],d[1]),g=new a.LinearFunction(c[2],d[2]),h=g.getIntersectionPoint(e),i=new a.Bounds([].concat(c,d));h?i.contains(h)||(d=d.reverse()):e._slope===g._slope&&(d=d.reverse()),e=null,f=null,g=null,h=null}return b=b.concat(c,d),this._originalPoints=b,b},getBounds:function(){for(var b=new a.LatLngBounds,c=0,d=this._latlngs.length;c<d;++c)b.extend(this._latlngs[c]);return b},getPathString:function(){var b=this.options.polygon,c=this._points;return this.options.polygon||(c=[c[1],c[4]]),new a.SVGPathBuilder(c,[],{closePath:b}).build(6)}}),a.WeightedLineSegment.include(LineTextFunctions),a.WeightedFlowLine=a.FlowLine.extend({initialize:function(b,c){a.setOptions(this,c),a.FlowLine.prototype.initialize.call(this,b,c),this._loaded=!1},_getAngle:function(a,b){var c=this._map.latLngToLayerPoint(a),d=this._map.latLngToLayerPoint(b),e=d.x-c.x,f=d.y-c.y,g=Math.atan(f/e);return g},_getAngles:function(a,b){var c=this._getAngle(a,b);isNaN(c)&&(c=0);var d=c+Math.PI/2,e=d+Math.PI;return[d,e]},onAdd:function(b){a.FlowLine.prototype.onAdd.call(this,b),this._data&&!this._loaded&&this._loadRecords(this._data)},_addLineSegment:function(b,c,d,e,f,g){var h=this._getAngles(b,c),i=(this._getDynamicOptions(e[f[g-1]]),this._getDynamicOptions(e[f[g]]));d.push(a.extend({latlng:b,angle:(h[0]+d[d.length-1].angle)/2},i.layerOptions));var j=new a.WeightedLineSegment(d[0],d[1],i.layerOptions);return this.addLayer(j),this.options.showLegendTooltips&&this._bindMouseEvents(j,i.layerOptions,i.legendDetails),this.onEachSegment(e[f[g-1]],e[f[g]],j),d},_loadRecords:function(b){if(this._map){var c=[],d=Object.keys(b);if(d.length>0){d=1===d.length?d.push(d[0]):d;var e=this._getLocation(b[d[0]],d[0]).center,f=this._getLocation(b[d[1]],d[1]).center,g=this._getAngles(e,f),h=this._getDynamicOptions(b[d[0]]);if(g.length>0){c.push(a.extend({latlng:e,angle:g[0]},h.layerOptions));for(var i=1,j=d.length-1;i<j;++i)e=f,f=this._getLocation(b[d[i+1]],d[i+1]).center,c=this._addLineSegment(e,f,c,b,d,i),c=c.slice(1);e=f,f=this._getLocation(b[d[d.length-1]]).center,this._addLineSegment(e,f,c,b,d,d.length-1)}this._loaded=!0}}}}),a.WeightedPolyline=a.FeatureGroup.extend({initialize:function(b,c){a.FeatureGroup.prototype.initialize.call(this,c),a.setOptions(this,c),this._latlngs=b},onAdd:function(b){a.LayerGroup.prototype.onAdd.call(this,b),this._loadComponents()},getBounds:function(){var b=new a.LatLngBounds;return this.eachLayer(function(a){b.extend(a.getBounds?a.getBounds():a.getLatLng())}),b},setLatLngs:function(a){this._latlngs=a,this._loaded=!0,this._loadComponents(),this.redraw()},getLatLngs:function(){return this._latlngs},options:{weightToColor:new a.HSLHueFunction([0,120],[20,-30])},_getAngle:function(a,b){var c=this._map.latLngToLayerPoint(a),d=this._map.latLngToLayerPoint(b),e=d.x-c.x,f=d.y-c.y,g=Math.atan(f/e);return g},_getAngles:function(a,b){var c=this._getAngle(a,b);isNaN(c)&&(c=0);var d=c+Math.PI/2,e=d+Math.PI;return[d,e]},_loadComponents:function(){if(!this._loaded){var b=[],c=this._latlngs[0],d=this._latlngs[1],e=this._getAngles(c,d);if(e.length>0){b.push({latlng:c,angle:e[0],lineWeight:c.weight});for(var f=1,g=this._latlngs.length-1;f<g;++f)c=this._latlngs[f],d=this._latlngs[f+1],e=this._getAngles(c,d),b.push({latlng:c,angle:e[0],lineWeight:c.weight}),this.addLayer(new a.WeightedLineSegment(b[0],b[1],this.options)),b=b.slice(1);c=a.extend({},d),d=this._latlngs[this._latlngs.length-1],b.push({latlng:c,angle:b[0].angle,lineWeight:d.weight}),this.addLayer(new a.WeightedLineSegment(b[0],b[1],this.options))}this._loaded=!0}}}),a.weightedPolyline=function(b,c){return new a.WeightedPolyline(b,c)},a.StackedPieChartMarker=a.ChartMarker.extend({initialize:function(b,c){a.setOptions(this,c),a.ChartMarker.prototype.initialize.call(this,b,c)},options:{weight:1,opacity:1,color:"#000",fill:!0,radius:10,rotation:0,numberOfSides:50,mouseOverExaggeration:1.2,maxDegrees:360,iconSize:new a.Point(50,40)},_loadComponents:function(){var b,c,d,e,f,g,h=0,i=1,j=0,k=0,l=0,m=(this.options.radius,this.options.barThickness),n=this.options.maxDegrees||360,o=0,p=this.options,q=this.options.data,r=this.options.chartOptions,s=function(a,b){var c=0;return a[b]&&(c=parseFloat(a[b])),c},t=0,u=[],v=[];for(e in q){for(b=s(q,e),g=0,f=0;f<q[e].length;++f)b=parseFloat(q[e][f]),g+=b;u.push(g),v.push(p.barThickness/g),h=h>g?h:g,j+=p.values[t],++t}if(i=p.barThickness/h,j>0){circle=new a.CircleMarker(this._latlng,{color:p.color,radius:m,fillColor:p.fillColor,fill:!0,iconSize:new a.Point(50,40)}),this._bindMouseEvents(circle),this.addLayer(circle),t=0;for(e in q){for(g=0,l=p.values[t]/j,k=l*n,p.startAngle=o,p.endAngle=o+k,f=0;f<q[e].length;++f)b=parseFloat(q[e][f]),g+=b,p.radius=g*v[t],p.barThickness=b*v[t],d=r[e],p.fillColor=this.options.fillColors[f],"transparent"==p.fillColor?p.fillOpacity=0:p.fillOpacity=1,p.color=d.color||"#000",p.radiusX=p.radius,p.radiusY=p.radius,p.rotation=0,p.key=e+" "+f,p.value=b,p.displayName=d.displayName,p.displayText=d.displayText,c=new a.RadialBarMarker(this._latlng,p),this._bindMouseEvents(c),this.addLayer(c);o=p.endAngle,t++}var w=function(a){return parseInt(100*a)+"%"};for(f=.2;f<1;f+=.2)circle=new a.CircleMarker(this._latlng,{value:f,color:p.color,radius:m*f,weight:1,dashArray:[5,5],fill:!1,iconSize:new a.Point(50,40),displayName:"percent",displayText:w}),this._bindMouseEvents(circle),this.addLayer(circle)}}}),a.stackedPieChartMarker=function(b,c){return new a.StackedPieChartMarker(b,c)},a.LayeredRegularPolygonMarker=a.MarkerGroup.extend({options:{levels:2,numberOfSides:50},setStyle:function(b){b.levels=b.levels||2;var c=b.radiusX||b.radius,d=b.radiusY||b.radius,e=c/(.75*b.levels),f=d/(.75*b.levels),g=a.extend({},b);c+=(b.levels-1)*e,d+=(b.levels-1)*f;var h=b.fillOpacity||.5,i=b.fillOpacity/(1.5*b.levels);h-=b.levels*i;for(var j=0;j<b.levels;++j)g.radius=0,g.radiusX=c,g.radiusY=d,g.fillOpacity=h,this._markers[j].setStyle(g),c-=e,d-=f,h+=i;return this},initialize:function(b,c){a.Util.setOptions(this,c),c.levels=c.levels||2;var d=[],e=c.radiusX||c.radius,f=c.radiusY||c.radius,g=e/(.75*c.levels),h=f/(.75*c.levels),i=a.extend({},c);e+=(c.levels-1)*g,f+=(c.levels-1)*h;var j=c.fillOpacity||.5,k=c.fillOpacity/(1.5*c.levels);j-=c.levels*k;for(var l=0;l<c.levels;++l)i.radius=0,i.radiusX=e,i.radiusY=f,i.fillOpacity=j,d.push(new a.RegularPolygonMarker(b,i)),e-=g,f-=h,j+=k;this._markers=d,a.MarkerGroup.prototype.initialize.call(this,b,d)}}),a.MapillaryLayer=a.PanoramioLayer.extend({options:{recordsField:null,locationMode:a.LocationModes.LATLNG,latitudeField:"lat",longitudeField:"lon",onEachRecord:function(b,c){var d=c.map_image_versions[1].url,e=c.location,f=this,g=640,h=640,i=2e4;b.on("click",function(c){var j=document.createElement("div"),k=a.DomUtil.create("div","",j);a.DomUtil.addClass(k,"panoramio-content");var l=a.DomUtil.create("img","photo",k);l.setAttribute("onload","this.style.opacity=1;"),l.setAttribute("src",d),l.style.width=g+"px";var m=a.DomUtil.create("div","photo-info",k);m.style.width=g-20+"px",m.innerHTML="<span>"+e+'</span><a class="photo-link" target="_blank" href="'+d+'"><img src="https://upload.wikimedia.org/wikipedia/commons/a/a8/Mapillary_logo.png" style="height: 14px;"/></a>';var n=new a.DivIcon({className:"photo-details",html:j.innerHTML,iconAnchor:[g/2,h/2]}),o=new a.Marker(c.target._latlng,{icon:n,zIndexOffset:i});o.on("click",function(a){f.removeLayer(a.target)}),b.viewedImage=o,f.viewedImage=o,f.addLayer(o)}),this.options.onEachPhoto&&this.options.onEachPhoto.call(this,b,c)},setIcon:function(b,c){var d=b.location,e=new a.Point(40,40),f=b.map_image_versions[0].url,g=new a.DivIcon({iconSize:e,className:"",html:'<img class="photo" onload="this.style.opacity=1" title="'+d+'" src="'+f+'"/>'});return g}},requestPhotos:function(){for(var a=this,b=this._map.getBounds(),c=b.getSouthWest(),d=b.getNorthEast();a._calls.length>0;)a._calls.pop().abort();var e=new XMLHttpRequest;e.onreadystatechange=function(){if(4==this.readyState&&200==this.status){var b=JSON.parse(e.responseText);a._count=b.length,a.fire("photosAvailable",b),a.clearLayers(),a.addData(b)}},e.open("GET","http://api.mapillary.com/v1/im/search?min-lat="+c.lat+"&max-lat="+d.lat+"&min-lon="+c.lng+"&max-lon="+d.lng+"&max-results=50",!0),e.send(null),a._calls.push(e)}})},window);